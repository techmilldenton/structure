!function(t){var e="",i='<div class="slider-item ui-widget-content item-text" data-top="0" data-left="0" data-width="100" data-height="50" data-borderstyle="solid" data-type="text" data-title="Text" style="width: 100px; height: 50px;"><div>Text</div><span class="sl-tl"></span><span class="sl-tr"></span><span class="sl-bl"></span><span class="sl-br"></span><span class="sl-top"></span><span class="sl-right"></span><span class="sl-bottom"></span><span class="sl-left"></span> </div>',s='<div class="slider-item ui-widget-content item-image" data-top="0" data-left="0" data-width="80" data-height="80" data-borderstyle="solid" style="height: 80px;width: 80px;" data-type="image"><img width="100%" height="100%" src="http://files.megadrupal.com/other/image.jpg" /><span class="sl-tl"></span><span class="sl-tr"></span><span class="sl-bl"></span><span class="sl-br"></span><span class="sl-top"></span><span class="sl-right"></span><span class="sl-bottom"></span><span class="sl-left"></span></div>',a='<div class="slider-item ui-widget-content item-video" data-top="0" data-left="0" data-width="80" data-height="80" data-borderstyle="solid" style="height: 80px;width: 80px;" data-type="video"><img width="100%" height="100%" src="http://files.megadrupal.com/other/video.jpg" /><span class="sl-tl"></span><span class="sl-tr"></span><span class="sl-bl"></span><span class="sl-br"></span><span class="sl-top"></span><span class="sl-right"></span><span class="sl-bottom"></span><span class="sl-left"></span><span class="sl-video-play"></span></div>';MegaSlider.Panel=function(){this.activePanel=null,this.selectedItem=null,this.tabCounter=t("#mdf-tabs ul.mdf-tabs-head li.tab-item").size(),this.toolbar=new MegaSlider.Toolbar(this),this.timeline=new MegaSlider.Timeline(this)},MegaSlider.Panel.prototype={constructor:MegaSlider.Panel,init:function(){this.initTab(),this.initPanel(),this.initDlgSetting(),this.initSliderItem(),this.toolbar.init(),this.timeline.init(),this.timeline.changeActivePanel(),this.triggerChangeSelectItem();var e=this;t(document).keydown(function(i){var s=i.keyCode||i.which,a=t(i.target).is("input, textarea, select");if(!a&&null!=e.selectedItem)switch(s){case 46:var n=e.selectedItem.data("timeline");return null!=n&&(n.remove(),e.selectedItem.remove(),e.triggerChangeSelectItem()),!1;case 37:var o=e.selectedItem.data("left")-5;return o=e.setPositionBoxLeft(e.selectedItem,o),e.toolbar.changePositionLeft(o),!1;case 38:var l=e.selectedItem.data("top")-5;return l=e.setPositionBoxTop(e.selectedItem,l),e.toolbar.changePositionTop(l),!1;case 39:var o=e.selectedItem.data("left")+5;return o=e.setPositionBoxLeft(e.selectedItem,o),e.toolbar.changePositionLeft(o),!1;case 40:var l=e.selectedItem.data("top")+5;return l=e.setPositionBoxTop(e.selectedItem,l),e.toolbar.changePositionTop(l),!1}}),t("form input").keypress(function(t){var e=t.keyCode||t.which;13==e&&t.preventDefault()});t("#mdf-full-screen-slider-preview").mdFullScreenSlider({transitionsSpeed:800,wrapHeight:"151",wrapWidth:"291",width:291,height:151,slideShow:!0,loop:!0,showBullet:!1,showThumb:!1,posBullet:1,posThumb:1,css3bg:"#000000",showLoading:!1,loadingPosition:"bottom",showArrow:!1,enableDrag:!0,preLoad:!1});t("#navbar-content-transitions li").hoverIntent(function(){var e=t("input",this).attr("value");t("#mdf-full-screen-slider-preview .mdf-slide-item").data("transition",e);var i=t(this).position(),s=t("#mdf-setting-dlg .mdf-setting-transition").position(),a=0,n=i.left-145+t(this).width()/2;a=i.top-s.top>161?i.top-161:i.top+2*t(this).height(),t("#mdf-transition-preview").css({left:n,top:a}).show()},function(){t("#mdf-transition-preview").hide()})},initTab:function(){var i=this;e=t("#tab-template").html(),t("#mdf-tabs").tabs({activate:function(e,s){t(i.activePanel).find(".slider-item.ui-selected").removeClass("ui-selected"),t("#mdf-tabs ul.mdf-tabs-head a.active").size()>0&&i.closeTabDialog(),i.activePanel=t(s.newPanel),i.timeline.changeActivePanel(),i.triggerChangeSelectItem()},create:function(e,s){i.activePanel=t(s.panel)}}),t("#mdf-tabs").find(".ui-tabs-nav").sortable({axis:"x",stop:function(){t("#mdf-tabs").tabs("refresh")}}),t("#add_tab").click(function(){return i.addTab(),!1})},initPanel:function(){var e=this;t(document).on("click","#mdf-tabs ul.mdf-tabs-head .panel-settings-link",function(){var i=t(this),s=t.stringToObject(t("input.tab-setting",e.activePanel).val());if(t(this).hasClass("active"))t("#mdf-setting-dlg").slideUp(),i.removeClass("active");else{var a=t("#mdf-tabs ul.mdf-tabs-head a.active");e.setTabDialogSetting(s),a.size()>0?(a.removeClass("active"),i.addClass("active")):(t("#mdf-setting-dlg").slideDown(),i.addClass("active"))}return!1}),t("#mdf-tabs a.button-close").click(function(){return t("#mdf-setting-dlg").slideUp(function(){t("#mdf-tabs ul.mdf-tabs-head a.active").removeClass("active")}),!1}),t("#mdf-slide-save").click(function(i){i.preventDefault();var s=e.getSliderData(),a={slide_data:s,action:"save"},n=t.objectToString(a);t("#edit-save-data").val(n),t("form").submit()}),t("#mdf-slide-download").click(function(){var i=e.getSliderData(),s={slide_data:i,action:"download"};return t("#edit-save-data").val(t.objectToString(s)),t("form").submit(),!1}),t("#mdf-slide-preview").click(function(){var i=e.getSliderData(),s=t("input[name=sid]").val();return t.post(Drupal.settings.basePath+"admin/structure/fullscreen-slider/preview",{sid:s,data:t.objectToString(i)},function(e){var i=t(".mdf-tabs-tool").offset();i.left+=.0425*t(document).width(),i.top-=t(document).scrollTop(),t("#fullscreen-slider-preview").empty().dialog({width:"91.5%",position:[i.left,i.top]}).html(e)}),!1}),t("#mdf-slide-exit").click(function(){return t("#exit-dialog").dialog({resizable:!1,height:200,width:300,modal:!0,buttons:{Exit:function(){for(var e=window.location.pathname.split("/"),i="",s=1;s<e.length-2;s++)i+="/"+e[s];window.location.replace(i),t(this).dialog("close")},Cancel:function(){t(this).dialog("close")}}}),!1})},initDlgSetting:function(){var e=this;t("#mdf-setting-dlg .row-clone a").click(function(){return e.cloneTab(e.activePanel),!1}),t("#mdf-setting-dlg .row-remove a").click(function(){if(e.activePanel){if(!confirm("Are you sure want to delete this slide? After accepting this slide will be removed completely."))return;var i=t.stringToObject(t("input.tab-setting",e.activePanel).val()),s=e.activePanel.attr("id"),a=!0;i.slideId>0&&t.post(Drupal.settings.basePath+"?q=admin/structure/fullscreen-slider/delete-slide",{slide_id:i.slideId},function(t){0==t.status&&(a=!1)}),a&&(t("#mdf-tabs .mdf-tabs-head li[aria-controls="+s+"]").remove(),t("#"+s).remove(),t("#mdf-tabs").tabs("refresh"),t("#mdf-tabs").tabs("option","active",0),e.closeTabDialog())}return!1}),t("#mdf-setting-dlg .row-image a.btn-choose").click(function(){return Drupal.media.popups.mediaBrowser(chooseBackground),!1}),t("#mdf-setting-dlg .img-preview img").bind("change",function(){t(this).attr("src")?t(this).parent().slideDown():t(this).parent().slideUp()}),t("#mdf-setting-dlg .del-img").click(function(){return t(this).prev().attr("src","").trigger("change"),!1}),t("#mdf-setting-dlg .row-thumbnail a.btn-choose").click(function(){return Drupal.media.popups.mediaBrowser(chooseThumbnail),!1}),t("#mdf-setting-dlg .del-thumb").click(function(){t(this).prev().attr("src","").trigger("change")}),t(".row-background-color input, .row-background-overlay input","#mdf-setting-dlg ").spectrum({clickoutFiresChange:!0,showInput:!0,showAlpha:!0,preferredFormat:"rgb"}),t("#tst-thumbnail").change(function(){t(this).is(":checked")?t("#mdf-setting-dlg .row-thumbnail > .row-inner").slideDown():t("#mdf-setting-dlg .row-thumbnail > .row-inner").slideUp()}),t("#tst-transition").change(function(){t(this).is(":checked")?t("#mdf-setting-dlg .row-transition > .row-inner").slideDown():t("#mdf-setting-dlg .row-transition > .row-inner").slideUp()}),t("#mdf-setting-dlg .button-apply").click(function(){var i=e.getTabDialogSetting();return t("input.tab-setting",e.activePanel).val(t.objectToString(i)),t(".mdf-slide-image img",e.activePanel).attr("src",i.bgImage),t(".mdf-slide-image",e.activePanel).css("background-color",i.bgColor),t(".mdf-slide-overlay",e.activePanel).css("background-color",i.bgOverlay),e.closeTabDialog(),!1}),t(".random-transition").click(function(){var e=Math.floor(5*Math.random()+3),i=t("ul.megaslider-3columns li").length;t("#navbar-content-transitions input").prop("checked",!1);for(var s=1;e>s;s++){var a=Math.floor(Math.random()*i+1);t("#transition-"+a).prop("checked",!0)}return!1})},closeTabDialog:function(){t("#mdf-setting-dlg").slideUp(function(){t("#mdf-tabs ul.mdf-tabs-head a.active").removeClass("active")})},initSliderItem:function(){var e=this;t("#mdf-tabs div.slider-item").each(function(){t(this).data("slidepanel",e).triggerItemEvent();var i=t(this).getItemValues();t(this).setItemStyle(i)})},setTabDialogSetting:function(e){t("input.setting-slideid","#mdf-setting-dlg").val(e.slideId?e.slideId:""),t("input.setting-bgfid","#mdf-setting-dlg").val(e.bgFid?e.bgFid:""),t(".row-image .img-preview img","#mdf-setting-dlg").attr("src",e.bgImage?e.bgImage:"").trigger("change"),t(".row-background-color input","#mdf-setting-dlg").spectrum("set",e.bgColor?e.bgColor:"rgba(0,0,0,0)"),t(".row-background-overlay input","#mdf-setting-dlg").spectrum("set",e.bgOverlay?e.bgOverlay:"rgba(0,0,0,0)"),t("#tst-thumbnail").prop("checked",e.customThumb).trigger("change"),t(".row-thumbnail .img-preview img","#mdf-setting-dlg").attr("src",e.thumb?e.thumb:"").trigger("change"),t("input.setting-thumbfid","#mdf-setting-dlg ").val(e.thumbFid?e.thumbFid:""),t("#tst-transition").attr("checked",e.customTransitionTime).trigger("change"),t(".row-transition input.trans-time","#mdf-setting-dlg").val(e.transitionTime),t("#navbar-content-transitions input").prop("checked",!1),Array.isArray(e.transitions)&&t.each(e.transitions,function(e,i){t("#navbar-content-transitions input[value="+i+"]").prop("checked",!0)})},getTabDialogSetting:function(){var e=[],i=t("#mdf-setting-dlg");return t("#navbar-content-transitions input:checked").each(function(){e.push(t(this).val())}),{slideId:t("input.setting-slideid",i).val(),bgFid:t("input.setting-bgfid",i).val(),bgImage:t(".row-image img",i).attr("src"),bgColor:t(".row-background-color input",i).val(),bgOverlay:t(".row-background-overlay input",i).val(),customThumb:t("#tst-thumbnail").is(":checked"),thumb:t(".row-thumbnail img",i).attr("src"),thumbFid:t("input.setting-thumbfid",i).val(),customTransitionTime:t("#tst-transition").is(":checked"),transitionTime:t(".row-transition input.trans-time",i).val(),transitions:e}},triggerChangeSelectItem:function(){if(null!=this.activePanel){var e=t(this.activePanel).find(".slider-item.ui-selected");1==e.size()?this.selectedItem=e:this.selectedItem=null,this.toolbar.changeSelectItem(this.selectedItem),this.timeline.changeSelectItem(this.selectedItem)}},addTab:function(){this.tabCounter++;var i="Slide "+this.tabCounter,s="tabs-"+this.tabCounter,a=t('<div id="'+s+'" class="tabs-panel"></div>');a.append(e).data("timelinewidth",t("#mdf-tabs").data("timelinewidth")),t("#mdf-tabs").append(a);var n=t('<li class="tab-item"><a class="tab-link" href="#'+s+'"><span class="tab-text">'+i+'</span></a><a class="panel-settings-link" href="#"></a></li>');n.appendTo("#mdf-tabs .mdf-tabs-head");var o=t("#mdf-tabs .ui-tabs-nav li").index(n);t("#mdf-tabs").tabs("refresh"),t("#mdf-tabs").tabs("option","active",o)},cloneTab:function(e){var i=this;i.addTab();var s="#tabs-"+i.tabCounter;t(s).find(".mdf-slide-image").html(e.find(".mdf-slide-image").html());var a=t.stringToObject(t("input.tab-setting",e).val());a.slideId=-1;var n=e.data("timelinewidth")?e.data("timelinewidth"):t("#mdf-tabs").data("timelinewidth");t(s).data("timelinewidth",n),t(s+" input.tab-setting").val(t.objectToString(a)),i.timeline.setTimelineWidth(a.transitiontime),t(".slider-item",e).each(function(){i.cloneBoxItem(t(this))})},cloneBoxItem:function(e){var n=this,o=t(e).getItemValues();if(o&&null!=n.activePanel){var l,d=o.type;return l="text"==d?t(i).clone():"image"==d?t(s).clone():t(a).clone(),l.data("slidepanel",n).appendTo(t(".mdf-objects",n.activePanel)).triggerItemEvent(),l.setItemValues(o),l.setItemStyle(o),l.setItemHtml(o),n.timeline.addTimelineItem(d,l),!0}},triggerChangeSettingItem:function(){this.toolbar.changeToolbarValue()},addBoxItem:function(e){if(null!=this.activePanel){var n;return n="text"==e?t(i).clone():"image"==e?t(s).clone():t(a).clone(),this.timeline.addTimelineItem(e,n),n.data("slidepanel",this).appendTo(t(".mdf-objects",this.activePanel)).triggerItemEvent(),this.changeSelectItem(n),this.timeline.triggerChangeOrderItem(),this.toolbar.focusEdit(),!0}return!1},changeSelectItem:function(e){t(this.activePanel).find(".slider-item.ui-selected").removeClass("ui-selected"),e.addClass("ui-selected"),this.triggerChangeSelectItem()},triggerChangeSelectItem:function(){if(null!=this.activePanel){var e=t(this.activePanel).find(".slider-item.ui-selected");1==e.size()?(this.selectedItem=e,this.toolbar.changeSelectItem(this.selectedItem),this.timeline.changeSelectItem(this.selectedItem)):0==e.size()?(this.selectedItem=null,this.toolbar.changeSelectItem(this.selectedItem),this.timeline.changeSelectItem(this.selectedItem)):(this.selectedItem=null,this.toolbar.changeSelectItem(this.selectedItem,!0),this.timeline.changeSelectItem(this.selectedItem))}},getAllItemBox:function(){return t("div.slider-item",this.activePanel)},changeTimelineValue:function(){this.toolbar.changeTimelineValue()},setTimelineWidth:function(e){this.activePanel&&t(this.activePanel).data("timelinewidth",e)},getTimelineWidth:function(){return this.activePanel?t(this.activePanel).data("timelinewidth"):null},setItemBorder:function(t,e){null!=this.selectedItem&&("all"==t?(this.selectedItem.data("borderAll",e),this.selectedItem.data("borderTop",e),this.selectedItem.data("borderRight",e),this.selectedItem.data("borderLeft",e),this.selectedItem.data("borderBottom",e),this.selectedItem.css({borderTop:e,borderRight:e,borderBottom:e,borderLeft:e})):"top"==t?(this.selectedItem.data("borderTop",e),this.selectedItem.css({borderTop:e})):"right"==t?(this.selectedItem.data("borderRight",e),this.selectedItem.css({borderRight:e})):"bottom"==t?(this.selectedItem.data("borderBottom",e),this.selectedItem.css({borderBottom:e})):(this.selectedItem.data("borderLeft",e),this.selectedItem.css({borderLeft:e})))},changeFontFamily:function(e){if(null!=this.selectedItem){JSON.stringify(e);t(this.selectedItem).data("font-family",e),t(this.selectedItem).css({"font-family":e})}},setItemSize:function(t,e){this.setBoxWidth(this.selectedItem,t),this.setBoxHeight(this.selectedItem,e)},setBoxWidth:function(e,i){if(i>0){var s=t(e).parent().width()-t(e).position().left;return i>s&&(i=s),t(e).width(i),t(e).data("width",i),i}return t(e).width()},setBoxHeight:function(e,i){if(i>0){var s=t(e).parent().height()-t(e).position().top;return i>s&&(i=s),t(e).height(i),t(e).data("height",i),i}return t(e).height()},setItemAttribute:function(t,e){if(null!=this.selectedItem)switch(t){case"left":return this.setPositionBoxLeft(this.selectedItem,e);case"top":return this.setPositionBoxTop(this.selectedItem,e)}},setPositionBoxLeft:function(e,i){i=i>0?i:0;var s=t(e).parent().width()-t(e).outerWidth(!0);return i>s&&(i=s),t(e).css("left",i+"px"),t(e).data("left",i),i},setPositionBoxTop:function(e,i){i=i>0?i:0;var s=t(e).parent().height()-t(e).outerHeight();return i>s&&(i=s),t(e).css("top",i+"px"),t(e).data("top",i),i},setItemData:function(e,i){null!=this.selectedItem&&t(this.selectedItem).data(e,i)},setItemCss:function(e,i){null!=this.selectedItem&&(t(this.selectedItem).data(e,i),t(this.selectedItem).css(e,i))},setItemBackground:function(e,i){if(null!=this.selectedItem){t(this.selectedItem).data(e,i);var s=t(this.selectedItem).data("backgroundColor");if(s&&""!=s){var a=parseInt(t(this.selectedItem).data("backgroundTransparent")),n=t.HexToRGB(s);a=a?a:100;var o="rgba("+n.r+","+n.g+","+n.b+","+a/100+")";this.selectedItem.css("backgroundColor",o)}else this.selectedItem.css("backgroundColor","transparent")}return!1},setItemShadow:function(e,i){if(null!=this.selectedItem){t(this.selectedItem).data(e,i);var s=t(this.selectedItem).getItemValues(),a=s.shadowAngle,n=s.shadowOffset,o=s.shadowBlur,l=s.shadowColor;if(null!=a&&null!=n&&null!=o&&null!=l){var d=Math.round(n*Math.cos((a-90)/180*Math.PI)),r=Math.round(n*Math.sin((a-90)/180*Math.PI)),c=d+"px "+r+"px "+parseInt(o)+"px "+l;this.selectedItem.css("box-shadow",c)}else this.selectedItem.css("box-shadow","none")}return!1},setPadding:function(e){if(null!=this.selectedItem){t(this.selectedItem).data("padding",e);var i={};if(e){var s=this.selectedItem.getItemValues();s.paddingTop&&(i["padding-top"]=s.paddingTop+"px"),s.paddingRight&&(i["padding-right"]=s.paddingRight+"px"),s.paddingBottom&&(i["padding-bottom"]=s.paddingBottom+"px"),s.paddingLeft&&(i["padding-left"]=s.paddingLeft+"px")}else i["padding-top"]=0,i["padding-right"]=0,i["padding-bottom"]=0,i["padding-left"]=0;t(this.selectedItem).css(i)}},setItemCssPx:function(e,i){null!=this.selectedItem&&(t(this.selectedItem).data(e,i),"fontSize"==e||"lineHeight"==e?t("div:first",this.selectedItem).css(e,i+"px"):this.selectedItem.css(e,i+"px"))},setItemFontWeight:function(e){null!=this.selectedItem&&(t(this.selectedItem).data("fontWeight",e),e=e.toString(),e.indexOf("italic")>0?(this.selectedItem.css("fontWeight",parseInt(e)),this.selectedItem.css("fontStyle","italic")):(this.selectedItem.css("fontWeight",parseInt(e)),this.selectedItem.css("fontStyle","normal")))},alignLeftSelectedBox:function(){var e=this,i=t(this.activePanel).find(".slider-item.ui-selected");if(i.size()>1){var s=1e4;i.each(function(){s=t(this).position().left<s?t(this).position().left:s}),i.each(function(){e.setPositionBoxLeft(this,s)})}},alignRightSelectedBox:function(){var e=this,i=t(this.activePanel).find(".slider-item.ui-selected");if(i.size()>1){var s=0;i.each(function(){var e=t(this).position().left+t(this).outerWidth();s=e>s?e:s}),i.each(function(){e.setPositionBoxLeft(this,s-t(this).outerWidth())})}},alignCenterSelectedBox:function(){var e=this,i=t(e.activePanel).find(".slider-item.ui-selected");if(i.size()>1){var s=i.first().position().left+i.first().outerWidth()/2;i.each(function(){e.setPositionBoxLeft(this,s-t(this).outerWidth()/2)})}},alignTopSelectedBox:function(){var e=this,i=t(e.activePanel).find(".slider-item.ui-selected");if(i.size()>1){var s=1e4;i.each(function(){s=t(this).position().top<s?t(this).position().top:s}),i.each(function(){e.setPositionBoxTop(this,s)})}},alignBottomSelectedBox:function(){var e=this,i=t(e.activePanel).find(".slider-item.ui-selected");if(i.size()>1){var s,a=0;i.each(function(){s=t(this).position().top+t(this).outerHeight(),a=s>a?s:a}),i.each(function(){e.setPositionBoxTop(this,a-t(this).outerHeight())})}},alignMiddleSelectedBox:function(){var e=this,i=t(e.activePanel).find(".slider-item.ui-selected");if(i.size()>1){var s=i.first().position().top+i.first().outerHeight()/2;i.each(function(){e.setPositionBoxTop(this,s-t(this).outerHeight()/2)})}},spaceVertical:function(e){var i=this,s=t(i.activePanel).find(".slider-item.ui-selected");if(s.size()>1){e=parseInt(e);for(var a=s.size(),n=0;a-1>n;n++)for(var o=n+1;a>o;o++)if(t(s[n]).position().top>t(s[o]).position().top){var l=s[n];s[n]=s[o],s[o]=l}if(e>0)for(var n=1;a>n;n++)i.setPositionBoxTop(t(s[n]),t(s[n-1]).position().top+t(s[n-1]).outerHeight()+e);else if(a>2){for(var d=0,n=0;a-1>n;n++)d+=t(s[n]).outerHeight();e=(t(s[a-1]).position().top-t(s[0]).position().top-d)/(a-1);for(var n=1;a-1>n;n++)i.setPositionBoxTop(t(s[n]),t(s[n-1]).position().top+t(s[n-1]).outerHeight()+e)}}},spaceHorizontal:function(e){var i=this,s=t(i.activePanel).find(".slider-item.ui-selected");if(s.size()>1){e=parseInt(e);for(var a=s.size(),n=0;a-1>n;n++)for(var o=n+1;a>o;o++)if(t(s[n]).position().left>t(s[o]).position().left){var l=s[n];s[n]=s[o],s[o]=l}if(e>0)for(var n=1;a>n;n++)i.setPositionBoxLeft(t(s[n]),t(s[n-1]).position().left+t(s[n-1]).outerWidth()+e);else if(a>2){for(var d=0,n=0;a-1>n;n++)d+=t(s[n]).outerWidth();e=(t(s[a-1]).position().left-t(s[0]).position().left-d)/(a-1);for(var n=1;a-1>n;n++)i.setPositionBoxLeft(t(s[n]),t(s[n-1]).position().left+t(s[n-1]).outerWidth()+e)}}},setItemTitle:function(e){null!=this.selectedItem&&(t(this.selectedItem).data("title",e),"text"==t(this.selectedItem).data("type")&&t(this.selectedItem).find("div").html(e.replace(/\n/g,"<br />")),this.timeline.changeSelectedItemTitle())},getSliderData:function(){var e=[];return t("#mdf-tabs .ui-tabs-nav a.tab-link").each(function(){var i=t(t(this).attr("href"));if(i.size()){var s=t.stringToObject(t("input.tab-setting",i).val());s.timelinewidth=i.data("timelinewidth");var a=[];t("div.slider-item",i).each(function(){a.push(t(this).getItemValues())}),e.push({itemsetting:s,boxitems:a})}}),e},setItemImageSrc:function(e,i,s){var a=this;null!=this.selectedItem&&(t(this.selectedItem).data("fileid",e),t(this.selectedItem).data("title",s),t(this.selectedItem).data("thumb",i),t(this.selectedItem).find("img").attr("src",i).load(function(){var t=new Image;t.src=i;var e=t.width,s=t.height,n=a.activePanel.find(".mdf-objects").width(),o=a.activePanel.find(".mdf-objects").height();s>0&&o>0&&(e>n||s>o?e/s>n/o?a.setItemSize(n,s*n/e):a.setItemSize(e*o/s,o):a.setItemSize(e,s),a.toolbar.changeSelectItem(a.selectedItem))}),this.timeline.changeSelectedItemTitle())},setVideoData:function(e,i,s,a){var n=this;null!=this.selectedItem&&(t(this.selectedItem).data("title",i),t(this.selectedItem).data("fileid",e),t(this.selectedItem).data("thumb",s),t(this.selectedItem).data("thumbid",a),t(this.selectedItem).find("img").attr("src",s).load(function(){var t=new Image;t.src=s;var e=t.width,i=t.height,a=n.activePanel.find(".mdf-objects").width(),o=n.activePanel.find(".mdf-objects").height();i>0&&o>0&&(e>a||i>o?e/i>a/o?n.setItemSize(a,i*a/e):n.setItemSize(e*o/i,o):n.setItemSize(e,i),n.toolbar.changeSelectItem(n.selectedItem))}),n.timeline.changeSelectedItemTitle())},setBorder:function(e){if(null!=this.selectedItem){t(this.selectedItem).data("border",e);var i={};if(e){var s=this.selectedItem.getItemValues();s.borderTop&&(i.borderTop=s.borderTop),s.borderRight&&(i.borderRight=s.borderRight),s.borderBottom&&(i.borderBottom=s.borderBottom),s.borderLeft&&(i.borderLeft=s.borderLeft),s.borderTopLeftRadius&&(i["border-top-left-radius"]=s.borderTopLeftRadius+"px"),s.borderTopRightRadius&&(i["border-top-right-radius"]=s.borderTopRightRadius+"px"),s.borderBottomRightRadius&&(i["border-bottom-right-radius"]=s.borderBottomRightRadius+"px"),s.borderBottomLeftRadius&&(i["border-bottom-left-radius"]=s.borderBottomLeftRadius+"px")}else i.borderTop="medium none",i.borderRight="medium none",i.borderBottom="medium none",i.borderLeft="medium none",i["border-top-left-radius"]=0,i["border-top-right-radius"]=0,i["border-bottom-right-radius"]=0,i["border-bottom-left-radius"]=0;t(this.selectedItem).css(i)}},setShadow:function(e){if(null!=this.selectedItem){t(this.selectedItem).data("shadow",e);if(e){var i=t(this.selectedItem).data("shadowAngle"),s=t(this.selectedItem).data("shadowOffset"),a=t(this.selectedItem).data("shadowBlur"),n=t(this.selectedItem).data("shadowColor");if(null!=i&&null!=s&&null!=a&&null!=n){var o=Math.round(s*Math.cos((i-90)/180*Math.PI)),l=Math.round(s*Math.sin((i-90)/180*Math.PI)),d=o+"px "+l+"px "+parseInt(a)+"px "+n;this.selectedItem.css("box-shadow",d)}else this.selectedItem.css("box-shadow","none")}else this.selectedItem.css("box-shadow","none")}}},chooseBackground=function(e){t("#mdf-setting-dlg .row-image .img-preview img").attr("src",e[0].url).trigger("change"),t("#mdf-setting-dlg .row-image .img-preview input").val(e[0].fid)},chooseThumbnail=function(e){t("#mdf-setting-dlg .row-thumbnail .img-preview img").attr("src",e[0].url).trigger("change"),t("#mdf-setting-dlg .row-thumbnail .img-preview input").val(e[0].fid)}}(jQuery);