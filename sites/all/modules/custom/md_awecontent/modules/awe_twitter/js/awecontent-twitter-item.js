(function(a){AWEContent.Models.Twitter=Backbone.Model.extend({});AWEContent.Collections.Twitter=Backbone.Collection.extend({model:AWEContent.Models.Twitter,url:AWEContent.Path.twitterAPI,initialize:function(c,b){this.url=(b||{}).url||AWEContent.Path.twitterAPI},parse:function(c){var b=this,d={};a.each(c,function(f,g){var e={};e.date=b.dating(g.created_at);e.user_name=g.user.name;e.retweeted=g.retweeted;e.avatar='<img src="'+g.user.profile_image_url+'" />';e.url="https://twitter.com/"+g.user.screen_name+"/status/"+g.id_str;e.tweet=(g.retweeted)?b.linking("RT @"+g.user.screen_name+": "+g.retweeted_status.text):b.linking(g.text);e.screen_name=b.linking("@"+g.user.screen_name);d[f]=e});return d},dating:function(f){var j=f.split(" ");f=new Date(Date.parse(j[1]+" "+j[2]+", "+j[5]+" "+j[3]+" UTC"));var c=["January","February","March","April","May","June","July","August","September","October","November","December"];var d={"%d":f.getDate(),"%m":f.getMonth()+1,"%b":c[f.getMonth()].substr(0,3),"%B":c[f.getMonth()],"%y":String(f.getFullYear()).slice(-2),"%Y":f.getFullYear()};var e=this.dateFormat;var h=e.match(/%[dmbByY]/g);for(var g=0,b=h.length;g<b;g++){e=e.replace(h[g],d[h[g]])}return e},linking:function(c){var b=c.replace(/(https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w\/_\.]*(\?\S+)?)?)?)/ig,'<a href="$1" target="_blank" title="Visit this link">$1</a>').replace(/#([a-zA-Z0-9_]+)/g,'<a href="https://twitter.com/search?q=%23$1&amp;src=hash" target="_blank" title="Search for #$1">#$1</a>').replace(/@([a-zA-Z0-9_]+)/g,'<a href="https://twitter.com/$1" target="_blank" title="$1 on Twitter">@$1</a>');return b},dateFormat:"%b/%d/%Y"});AWEContent.Views.TwitterView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render");var b=this;this.collection.fetch({success:function(){b.render()}})},templating:function(f){var c=this.collection.template,e=["date","tweet","avatar","url","retweeted","screen_name","user_name"];for(var d=0,b=e.length;d<b;d++){c=c.replace(new RegExp("{{"+e[d]+"}}","gi"),f[e[d]])}return c},render:function(){var b=this,d=this.collection.toJSON()[0],e="";b.listTwitter=[];a.each(d,function(f,g){b.listTwitter.push("<li>"+b.templating(g)+"</li>")});a(".awe-twitter",this.el).empty().append('<ul class="awe-twitter-list"></ul>').data("listTwitter",b.listTwitter);for(var c=0;c<b.collection.numberTwitter;c++){a(".awe-twitter-list",b.el).append(b.listTwitter[c])}a(".awe-item-preload",b.$el).remove()}});AWEContent.Models.TwitterItem=AWEContent.Models.Item.extend({defaults:{machine_name:"twitter",tagName:"div",numberTwitter:5,dateFormat:"%b/%d/%Y",template:'<strong class="date">{{date}}</strong> - {{screen_name}} {{tweet}}',sliderTwitter:0,timeAuto:-1,navigation:"button",stopOnHover:1,boxModelSettings:{},twitterID:"",twitterClass:"",customEnableAttributes:0,customDataAttributes:"[]",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:"",previewAnimations:0,lgResponsive:true,xsResponsive:true,mediumResponsive:true,smResponsive:true},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.TwitterItem({model:this})},clone:function(){var b={};a.each(this.toJSON(),function(c,d){b[c]=d});b.boxModelSettings=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);return new AWEContent.Models.TwitterItem(b)}});AWEContent.Views.TwitterItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var b=this,c=a('<div class="awe-item awe-twitter '+b.cid+'"><div class="awe-item-preload"></div></div>'),d=b.model.toJSON();b.renderTwitter(d);c.renderItemDefaultAttributes(d.customEnableAttributes,d.customDataAttributes);c.renderItemDefaultBoxModel(d.boxModelSettings);c.attr("id",d.twitterID).addClass(d.twitterClass);if(d.customEnableAnimations){var e=d.customDataAnimations;c.processAnimations(e)}b.$el.defaultResponsive(d);AWEContent.Library.addLibrary("owlCarousel",function(){if(d.sliderTwitter){var f=setInterval(function(){if(a(".awe-twitter."+b.cid+" ul li",b.el).length){clearInterval(f);a(".awe-twitter."+b.cid+" ul li",b.el).show();b.sliderTwitter()}},50)}});return c},applySettingsChanged:function(e,j){var h=this,b=h.model.toJSON(),f=a(".awe-twitter",h.el),g=f.data("listTwitter"),c=a(".awe-twitter-list",h.el),i=b.numberTwitter,d=h.$el.height();a.each(e.changed,function(m,o){h.$el.changeResponsive(m,o);f.renderChangeSettingBoxModel(m,o,e);switch(m){case"numberTwitter":if(b.sliderTwitter){h.$owlSlide.data("owlCarousel").destroy()}c.empty();for(var l=0;l<b.numberTwitter;l++){c.append(g[l])}if(b.sliderTwitter){h.sliderTwitter()}break;case"dateFormat":case"template":f.html('<img style="display: block; margin: 0 auto;" src="/awecontent/img/preload.gif" />');h.renderTwitter(b);break;case"sliderTwitter":if(o){h.sliderTwitter()}else{h.$owlSlide.data("owlCarousel").destroy()}break;case"navigation":if(b.navigation=="none"){h.stOwlSlide.pagination=false}else{h.stOwlSlide.pagination=true;h.stOwlSlide.paginationNumbers=b.navigation=="number"?true:false}h.$owlSlide.data("owlCarousel").reinit(h.stOwlSlide);break;case"stopOnHover":h.stOwlSlide.stopOnHover=b.stopOnHover?true:false;h.$owlSlide.data("owlCarousel").reinit(h.stOwlSlide);break;case"timeAuto":if(b.timeAuto==-1){h.stOwlSlide.autoPlay=true}else{h.stOwlSlide.autoPlay=b.timeAuto}h.$owlSlide.data("owlCarousel").reinit(h.stOwlSlide);break;case"twitterID":a(".awe-twitter",h.el).attr("id",o);break;case"twitterClass":var p=h.model.previousAttributes().twitterClass;f.removeClass(p).addClass(o);break;case"customEnableAttributes":f.renderChangeSettingsAttributes(m,o,b.customDataAttributes);break;case"customActionAttributes":f.renderChangeSettingsAttributes(m,o);break;case"customEnableAnimations":case"customDataAnimations":var n=o;var k=h.model.previousAttributes().customDataAnimations;f.processAnimations(n,k);break;case"previewAnimations":if(o){n=b.customDataAnimations;k=h.model.previousAttributes().customDataAnimations;h.model.set("previewAnimations",0);a(".awe-twitter",h.el).processAnimations(n,k)}break}});setTimeout(function(){h.checkChangeHeight(d)},50)},renderTwitter:function(b){var c=new AWEContent.Collections.Twitter([],{url:AWEContent.Path.twitterAPI});c.numberTwitter=b.numberTwitter;c.dateFormat=b.dateFormat;c.template=b.template;return new AWEContent.Views.TwitterView({el:this.$el,collection:c})},sliderTwitter:function(){var c=this,d=c.model.toJSON(),b=AWEContent.jqIframe(".awe-twitter-list",c.el);c.stOwlSlide={items:1,autoPlay:d.timeAuto==-1?5000:d.timeAuto,pagination:d.navigation=="none"?false:true,paginationNumbers:d.navigation=="number"?true:false,navigation:false,stopOnHover:d.stopOnHover?true:false};c.$owlSlide=b.owlCarousel(c.stOwlSlide)}});AWEContent.Views.TwitterItemController=AWEContent.Views.ItemController.extend({machineName:"twitter",controllerHtml:function(){return'<i class="ic ac-icon-twitter"></i>'},createItemModel:function(b){var c;if(b){c=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);b.boxModelSettings=c;return new AWEContent.Models.TwitterItem(b)}else{c=new AWEContent.Models.BoxModelSettings();return new AWEContent.Models.TwitterItem({boxModelSettings:c})}}});AWEContent.Views.TwitterPanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel panel-twitter",panelName:"twitter",initialize:function(){AWEContent.Views.ItemPanel.prototype.initialize.call(this)},initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var b=this;a("#twitter-number-twitter",b.el).change(function(d,c){b.editingModel.set("numberTwitter",c.value)});a("#text-twitter-format-date",b.el).change(function(){b.editingModel.set("dateFormat",a(this).val())});a("#textarea-twitter-template",b.el).change(function(){b.editingModel.set("template",a(this).val())});a("#text-twitter-custom-id",b.el).change(function(){b.editingModel.set("twitterID",a(this).val())});a("#text-twitter-custom-class",b.el).change(function(){b.editingModel.set("twitterClass",a(this).val())});a("#twitter-twitter-slide input",b.el).change(function(e,d){var c=parseInt(a(this).val());if(!d){b.editingModel.set("sliderTwitter",c)}a("#twitter-navigation, #twitter-stop-on-hover, #twitter-time-auto",b.el).css("display",c?"":"none")});a("#twitter-navigation",b.el).change(function(d,c){b.editingModel.set("navigation",c.value)});a("#twitter-stop-on-hover input",b.el).change(function(d,c){if(!c){b.editingModel.set("stopOnHover",parseInt(a(this).val()))}});a("#twitter-time-auto .slider-val",b.el).mousedown(function(){a(this).data("mouseup",false)});a(document).mouseup(function(){var c=a("#twitter-time-auto"),d=a(".slider-val",c),e=a(".display-font",c);if(d.data("mouseup")!=undefined&&!d.data("mouseup")){d.data("mouseup",true);e.trigger("change")}});a("#twitter-time-auto .display-font",this.el).change(function(d,c){var f=a(this).closest(".md-box").find(".slider-val"),e=parseInt(a(this).text());if(!c&&f.data("mouseup")){if(isNaN(e)){e=-1}b.editingModel.set("timeAuto",e)}a(this).text()=="-1"?a(this).text("DF"):""});a("#twitter-column-box-model",b.el).initBoxModelPanel(b,"boxModelSettings");a("#twitter-custom-atributes",this.el).initAttributesPanel(b);a("#twitter-animations",this.el).change(function(c,d){b.editingModel.set("customEnableAnimations",d.enabled);if(d){b.editingModel.set("customDataAnimations",JSON.stringify(d.animations));if(d.previewAnimations){b.editingModel.set("previewAnimations",1)}}})},setPanelElementsValue:function(){var b=this,c=this.editingModel.toJSON();a("#twitter-number-twitter .display-font",b.el).text(c.numberTwitter);a("#text-twitter-format-date ",this.el).val(c.dateFormat);a("#textarea-twitter-template",b.el).val(c.template);a("#twitter-twitter-slide input",b.el).val(c.sliderTwitter).trigger("change",true);a("#twitter-navigation",b.el).aweSelect("value",c.navigation);a("#twitter-stop-on-hover input[name=toggle_value]",b.el).val(c.stopOnHover).trigger("change",true);a("#twitter-time-auto .display-font",this.el).text(c.timeAuto).trigger("change",{isPanel:true});a("#twitter-time-auto .slider-val",this.el).slider("value",c.timeAuto);a("#text-twitter-custom-id",b.el).val(c.twitterID);a("#text-twitter-custom-class",b.el).val(c.twitterClass);a("#twitter-column-box-model",this.$el).initBoxModel(c.boxModelSettings);a("#twitter-custom-attributes",this.el).initAttributes(c.customEnableAttributes,c.customDataAttributes);a("#twitter-animations",this.el).aweAnimation("value",{enabled:c.customEnableAnimations,animations:c.customDataAnimations,previewEl:b.editingModel.view.$el})},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Twitter</h2></div>'},custom_attributes:{type:"section",number_twitter:{type:"slider",title:"No of tweet",values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],default_value:5,allow_type:true},format_date:{type:"text_field",title:"Date Format",default_value:"%b/%d/%Y"},date_description:{type:"markup",markup:"<table class='option-tiwtter'><thead><tr><th>Format</th><th>Description</th></tr></thead><tbody><tr><td><code>%d</code></td><td>Date, 1,2,3...</td></tr><tr><td><code>%m</code></td><td>Month number 1,2,3...</td></tr><tr><td><code>%b</code></td><td>Abbreviated month Jan, Feb, Mar...</td></tr><tr><td><code>%B</code></td><td>Full month January, February, March...</td></tr><tr><td><code>%y</code></td><td>Last two digits of year, 11,12,13...</td></tr><tr><td><code>%Y</code></td><td>Full year 2011, 2012, 2013...</td></tr></tbody></table>"},template:{type:"textarea_field",title:"Desctiption",default_value:'<strong class="date">{{date}}</strong> - {{screen_name}} {{tweet}}'},template_description:{type:"markup",markup:"<table class='option-tiwtter'> <thead> <tr> <th>Template</th> <th>Description</th> </tr></thead> <tbody> <tr> <td><code>{{tweet}}</code> </td><td>Tweet content</td></tr><tr> <td><code>{{date}}</code> </td><td>Formatted tweet date</td></tr><tr> <td><code>{{avatar}}</code> </td><td>User's Avatar Image</td></tr><tr> <td><code>{{url}}</code> </td><td>Direct URL to the tweet</td></tr><tr> <td><code>{{retweeted}}</code> </td><td>Returns <code>true</code> or <code>false</code> if tweet is retweeted</td></tr><tr> <td><code>{{screen_name}}</code> </td><td>Screen name of person who posted the tweet</td></tr><tr> <td><code>{{user_name}}</code> </td><td>Username of person who posted the tweet</td></tr></tbody></table>"},twitter_slide:{type:"toggle",title:"Twitter Slide",default_value:1},navigation:{type:"select",title:"Navigation",options:{none:"None",button:"Button",number:"Number"},default_value:"none"},stop_on_hover:{type:"toggle",title:"Stop On Hover",default_value:1},time_auto:{type:"slider",title:"Time Auto",min_value:-1,max_value:10000,default_value:5000,allow_type:true,only_change_mouseup:true,unit:"ms"}},custom_box_model:{type:"section",column_box_model:{type:"tabs",tabs:[{tab_title:"Border",contents:{custom_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{custom_border_radius:{type:"box_model",model_type:"border_radius",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Padding",contents:{custom_padding:{type:"box_model",model_type:"padding",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Margin",contents:{custom_margin:{type:"box_model",model_type:"margin",allow_type:true,min_value:0,max_value:100,default_value:0}}}]}},custom_definitions:{type:"section",custom_id:{type:"text_field",title:"ID",attributes:{placeholder:"Custom ID"},default_value:""},custom_class:{type:"text_field",title:"CSS class",attributes:{placeholder:"Custom class"},default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}});a(document).ready(function(){AWEContent.Controllers.twitter=new AWEContent.Views.TwitterItemController();AWEContent.Panels.twitter=new AWEContent.Views.TwitterPanel()})})(jQuery);