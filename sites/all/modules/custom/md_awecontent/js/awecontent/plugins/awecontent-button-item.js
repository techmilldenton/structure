(function(a){AWEContent.Models.ButtonItem=AWEContent.Models.Item.extend({defaults:{machine_name:"button",buttonUrl:"",buttonStyle:"none",textButton:"Button",color:"",backgroundColor:"",hoverColor:"",hoverBackgroundColor:"",fontFamily:"",fontStyle:"",fontSize:-1,lineHeight:-1,letterSpacing:-1,openNewWindow:1,boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type": "none"}',lgResponsive:true,xsResponsive:true,mediumResponsive:true,smResponsive:true},createView:function(){this.view=new AWEContent.Views.ButtonItem({model:this})},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],clone:function(){var b={};a.each(this.toJSON(),function(c,d){b[c]=d});b.boxModelSettings=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);return new AWEContent.Models.ButtonItem(b)}});AWEContent.Views.ButtonItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var c=this,f=a('<a href="" class="awe-btn awe-item"></a>'),b=a("<style></style>"),d=c.model.toJSON(),e={"font-size":d.fontSize==-1?"":(d.fontSize+"px"),"line-height":d.lineHeight==-1?" ":(d.lineHeight+"px"),"letter-spacing":d.letterSpacing==-1?"":(d.letterSpacing+"px"),"font-family":d.fontFamily};if(d.fontStyle){e=a.extend({},e,JSON.parse(d.fontStyle))}c.$el.append(b);c.classButton="awe-button-"+c.cid;c.enableEditText=0;f.attr({href:d.buttonUrl,id:d.customID}).addClass(d.customClass+" "+c.classButton+" "+d.buttonStyle).html(d.textButton).css(e).renderItemDefaultBoxModel(d.boxModelSettings);if(d.openNewWindow){f.attr("target","_blank")}f.renderItemDefaultAttributes(d.customEnableAttributes,d.customDataAttributes);if(d.customEnableAnimations){f.processAnimations(d.customDataAnimations)}if(d.textHover!=""){f.attr("data-hover",d.textHover)}b.html(c.processStyle());c.iframeJQuery(this.el).delegate(".awe-btn.awe-item","itemReady",function(){var g,h;c.iframeJQuery(this).hallo({plugins:{halloformat:{}},editable:true,create:function(){this.addEventListener("paste",function(i){i.preventDefault();var j=i.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",false,j)})},activated:function(i){g=a(i.target).height()},deactivated:function(i){c.changeContent(i);h=a(i.target).height();if(h!=g){c.resizeItem()}}})});c.$el.defaultResponsive(d);return f},applySettingsChanged:function(d){var c=this,g=a(".awe-btn",c.$el),b=a("style",c.$el),e=d.toJSON(),f=c.$el.height();a.each(d.changedAttributes(),function(i,k){c.$el.changeResponsive(i,k);g.renderChangeSettingBoxModel(i,k,d);switch(i){case"buttonUrl":g.attr("href",k);break;case"buttonStyle":var m=c.model.previousAttributes().buttonStyle;g.removeClass(m).addClass(k);break;case"textButton":g.html(k);break;case"textHover":g.attr("data-hover",k);break;case"color":case"backgroundColor":case"hoverColor":case"hoverBackgroundColor":c.generateStyle();break;case"fontFamily":g.css("font-family",k);break;case"fontStyle":var n=(k)?JSON.parse(k):{"font-weight":"","font-style":""};g.css(n);break;case"fontSize":k==-1?g.css("font-size",""):g.css("font-size",k+"px");break;case"lineHeight":k==-1?g.css("line-height",""):g.css("line-height",k+"px");break;case"letterSpacing":k==-1?g.css("letter-spacing",""):g.css("letter-spacing",k+"px");break;case"openNewWindow":var l=k?"_blank":"_self";g.attr("target",l);break;case"customID":g.attr("id",k);break;case"customClass":var m=c.model.previousAttributes().customClass;g.removeClass(m).addClass(k);break;case"customEnableAttributes":g.renderChangeSettingsAttributes(i,k,e.customDataAttributes);break;case"customActionAttributes":g.renderChangeSettingsAttributes(i,k);break;case"customEnableAnimations":var j,h;if(k){j=e.customDataAnimations;h=null;g.processAnimations(j)}else{j=null;h=e.customDataAnimations;g.processAnimations(j,h)}break;case"customDataAnimations":var j,h;j=e.customDataAnimations;h=c.model.previousAttributes().customDataAnimations;g.processAnimations(j,h);break}});setTimeout(function(){c.checkChangeHeight(f)},50)},changeContent:function(e){var c=this,d=c.model.toJSON(),b=a(e.currentTarget).html();this.model.set("textButton",b)},editText:function(c){var b=this;if(!b.enableEditText){b.iframeJQuery("a",b.el).hallo({plugins:{halloformat:{}},editable:true,create:function(){this.addEventListener("paste",function(d){d.preventDefault();var f=d.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",false,f)})},deactivated:function(d){b.changeContent(d)}});b.enableEditText=1}},processStyle:function(){var c=this.model.toJSON(),b;b="."+this.classButton+".awe-btn {color :"+c.color+";background-color:"+c.backgroundColor+";} ."+this.classButton+".awe-btn:hover {color :"+c.hoverColor+";background:"+c.hoverBackgroundColor+";}";return b},generateStyle:function(){var b=this,d="",c=this.model.toJSON();if(b.updateColor){clearTimeout(b.updateColor)}b.updateColor=setTimeout(function(){d="."+b.classButton+".awe-btn {color :"+c.color+";background-color:"+c.backgroundColor+";} ."+b.classButton+".awe-btn:hover {color :"+c.hoverColor+";background:"+c.hoverBackgroundColor+";}";a("style",b.el).html(d);b.updateColor=false},100)}});AWEContent.Views.ButtonItemController=AWEContent.Views.ItemController.extend({machineName:"button",controllerHtml:function(){return'<div class="title-icon">Button</div><i class="ic ac-icon-button"></i>'},createItemModel:function(b){var c;if(b!=undefined){c=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);b.boxModelSettings=c;return new AWEContent.Models.ButtonItem(b)}return new AWEContent.Models.ButtonItem({boxModelSettings:new AWEContent.Models.BoxModelSettings()})}});AWEContent.Views.ButtonPanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel panel-button",panelName:"button",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var b=this;a("#text-button-text-content",b.el).change(function(){b.editingModel.set("textButton",a(this).val())});a("#text-button-enter-link",this.el).change(function(){b.editingModel.set("buttonUrl",a(this).val())});a("#button-select-style",this.el).change(function(d,c){b.editingModel.set("buttonStyle",c.value)});a("#button-text-color",this.el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("color",c)});a("#button-background-color",this.el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("backgroundColor",c)});a("#button-hover-text-color",this.el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("hoverColor",c)});a("#button-hover-background-color",b.el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("hoverBackgroundColor",c)});a("#button-font-name",this.$el).bind("fontFamilyChange",function(d,c){b.editingModel.set("fontFamily",c)}).bind("fontStyleChange",function(c,d){b.editingModel.set("fontStyle",d.value)}).bind("textAlignChange",function(d,c){b.editingModel.set("textAlign",c.value)}).bind("fontSizeChange",function(c,d){b.editingModel.set("fontSize",d.value)}).bind("letterSpacingChange",function(c,d){b.editingModel.set("letterSpacing",d.value)}).bind("lineHeightChange",function(d,c){b.editingModel.set("lineHeight",c.value)});a("#button-target-blank input",b.el).change(function(d,c){if(!c){b.editingModel.set("openNewWindow",parseInt(a(this).val()))}});a("#button-column-box-model",b.el).initBoxModelPanel(b,"boxModelSettings");a("#text-button-custom-id",b.el).change(function(){b.editingModel.set("customID",a(this).val())});a("#text-button-custom-class",b.el).change(function(){b.editingModel.set("customClass",a(this).val())});a("#button-custom-attributes",this.el).initAttributesPanel(b);a("#button-animations",this.el).change(function(c,d){b.editingModel.set("customEnableAnimations",d.enabled);if(d){b.editingModel.set("customDataAnimations",d.animations)}})},setPanelElementsValue:function(){var b=this,c=this.editingModel.toJSON();a("#text-button-enter-link",b.el).val(c.buttonUrl);a("#button-select-style",this.el).aweSelect("value",c.buttonStyle);a("#text-button-text-content",this.el).val(c.textButton);a("#button-text-color",b.el).aweColorPicker("value",c.color);a("#button-background-color",b.el).aweColorPicker("value",c.backgroundColor);a("#button-hover-text-color",b.el).aweColorPicker("value",c.hoverColor);a("#button-hover-background-color",b.el).aweColorPicker("value",c.hoverBackgroundColor);a("#button-font-name",this.$el).aweFont("options",{fontFamily:c.fontFamily,fontStyle:c.fontStyle,fontSize:c.fontSize,textAlign:c.textAlign,letterSpacing:c.letterSpacing,lineHeight:c.lineHeight});a("#button-target-blank input",b.el).val(c.openNewWindow).trigger("change");a("#button-column-box-model",b.el).initBoxModel(c.boxModelSettings);a("#text-button-custom-id",b.el).val(c.customID);a("#text-button-custom-class",b.el).val(c.customClass);a("#button-custom-attributes",this.el).initAttributes(c.customEnableAttributes,c.customDataAttributes);a("#button-animations",this.el).aweAnimation("value",{enabled:c.customEnableAnimations,animations:c.customDataAnimations,previewEl:this.editingModel.view.$el})},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Button</h2></div>'},custom_attributes:{type:"section",enter_link:{type:"text_field",title:"Link",attributes:{placeholder:"http://..."},default_value:"http://"},select_style:{type:"select",title:"Style",options:{none:"None","hvr-fade":"Fade","hvr-sweep-to-right":"Sweep To Right","hvr-sweep-to-left":"Sweep To Left","hvr-sweep-to-bottom":"Sweep To Bottom","hvr-sweep-to-top":"Sweep To Top"},default_value:"none"}},custom_color:{type:"section","text-color":{type:"colorpicker",title:"Button text color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}},background_color:{type:"colorpicker",title:"Button background",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}},hover_text_color:{type:"colorpicker",title:"Button hover text color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}},hover_background_color:{type:"colorpicker",title:"Button hover background",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}}},custom_text:{type:"section",font_name:{type:"font",disabledElements:["textAlign"]}},custom_target:{type:"section",target_blank:{type:"toggle",title:"Open in new window",default_value:0}},custom_box_model:{type:"section",column_box_model:{type:"tabs",tabs:[{tab_title:"Border",contents:{custom_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{custom_border_radius:{type:"box_model",model_type:"border_radius",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Padding",contents:{custom_padding:{type:"box_model",model_type:"padding",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Margin",contents:{custom_margin:{type:"box_model",model_type:"margin",allow_type:true,min_value:0,max_value:100,default_value:0}}}]}},custom_definitions:{type:"section",custom_id:{type:"text_field",title:"ID",attributes:{placeholder:"Custom ID"},default_value:""},custom_class:{type:"text_field",title:"CSS class",attributes:{placeholder:"Custom class"},default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}});a(document).ready(function(){AWEContent.Controllers.button=new AWEContent.Views.ButtonItemController();AWEContent.Panels.button=new AWEContent.Views.ButtonPanel()})})(jQuery);