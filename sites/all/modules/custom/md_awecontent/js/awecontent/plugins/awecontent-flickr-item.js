(function(a){AWEContent.Models.Flick=Backbone.Model.extend({});AWEContent.Collections.Flicks=Backbone.Collection.extend({model:AWEContent.Models.Flick,stream:"group",id:"130337024@N06",url:function(){var c=this.stream,d=this.id,b=(c=="user")?"https://api.flickr.com/services/feeds/photos_public.gne":"https://api.flickr.com/services/feeds/groups_pool.gne";return b+"?id="+d+"&format=json&jsoncallback=?"},parse:function(b){return b.items}});AWEContent.Views.FlicksView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render");var b=this;this.collection.fetch({success:function(){b.render()}})},template:_.template('<li class="awe-item-flickr">                <a target="_blank" href="<%= href %>" data-group="example-set" title="Title: <%= title %>" class="<%= lightbox %>">                <img src="<%= src %>" alt="image-flickr"></a>            </li>'),render:function(){var d=this,c=d.collection.numberPhoto-1,f=d.collection.numberColum,e=d.collection.lightbox,b="";a.each(this.collection.toJSON(),function(j,i){var l=i.media.m.replace("_m.jpg",""),g=l+"_q.jpg",n=l+"_c.jpg",k=i.link,h=e=="openlightbox"?n:k,m=i.title;b+=d.template({href:h,src:g,title:m,lightbox:e})});a(".awe-flickr",this.el).html('<ul class="awe-flickr-list">'+b+"</ul>").addClass("type-column-"+f);a(".awe-flickr li:gt("+c+")",this.el).hide().find("a").removeClass("openlightbox");a(".awe-item-preload",this.$el).remove();this.$el.trigger("flickrReady")}});AWEContent.Models.FlickrItem=AWEContent.Models.Item.extend({defaults:{machine_name:"flickr",tagName:"div",flickrID:"113963751@N02",numberPhoto:"12",numberColum:"4",imageMargin:3,flickrStream:"user",flickrPreview:"openlightbox",boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type" : "none"}',lgResponsive:true,xsResponsive:true,mediumResponsive:true,smResponsive:true},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.FlickrItem({model:this})},clone:function(){var b={};a.each(this.toJSON(),function(c,d){b[c]=d});b.boxModelSettings=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);return new AWEContent.Models.FlickrItem(b)}});AWEContent.Views.FlickrItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);var b=this;this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged);AWEContent.Library.addLibrary("magnific",function(){b.openlightbox(b)})},renderItemContent:function(){var b=this,d=a('<div class="awe-item awe-flickr"><div class="awe-item-preload"></div></div>'),c=b.model.toJSON();b.renderFlick(c);d.attr("id",c.customID).addClass(c.customClass);d.renderItemDefaultAttributes(c.customEnableAttributes,c.customDataAttributes);d.renderItemDefaultBoxModel(c.boxModelSettings);if(c.customEnableAnimations){var e=c.customDataAnimations;d.processAnimations(e)}b.$el.defaultResponsive(c);this.$el.bind("flickrReady",function(f){if(c.imageMargin){a(".awe-item-flickr",b.$el).css({padding:c.imageMargin+"px"});a(".awe-item ul",b.$el).css({margin:"-"+c.imageMargin+"px"})}});return d},applySettingsChanged:function(c){var b=this,e=b.model.toJSON(),h=e.numberColum,d=e.numberPhoto-1,g=a(".awe-flickr",b.el),f=b.$el.height();a.each(c.changed,function(j,m){b.$el.changeResponsive(j,m);g.renderChangeSettingBoxModel(j,m,c);switch(j){case"flickrID":case"flickrStream":b.renderFlick(e);break;case"numberColum":var k="type-column-"+b.model.previousAttributes().numberColum;a(".awe-flickr ul",b.$el).removeClass().addClass("awe-flickr-list "+e.customClass+"");a(".awe-flickr",b.$el).removeClass(k).addClass("type-column-"+h);break;case"numberPhoto":a(".awe-flickr ul li:gt("+d+")",b.$el).hide().find("a").removeClass("openlightbox");a(".awe-flickr ul li:lt("+(d+1)+")",b.$el).show().find("a").addClass("openlightbox");break;case"flickrPreview":b.renderFlick(e);break;case"imageMargin":if(m==-1){a(".awe-item-flickr",b.$el).css({padding:""});a(".awe-item ul",b.$el).css({margin:""})}else{a(".awe-item-flickr",b.$el).css({padding:m+"px"});a(".awe-item ul",b.$el).css({margin:"-"+m+"px"})}break;case"customID":g.attr("id",m);break;case"customClass":var n=b.model.previousAttributes().customClass;g.removeClass(n).addClass(m);break;case"customActionAttributes":g.renderChangeSettingsAttributes(j,m);break;case"customEnableAttributes":g.renderChangeSettingsAttributes(j,m,e.customDataAttributes);break;case"customEnableAnimations":var l,i;if(m){l=e.customDataAnimations;i=null;g.processAnimations(l)}else{l=null;i=e.customDataAnimations;g.processAnimations(l,i)}break;case"customDataAnimations":var l,i;l=e.customDataAnimations;i=b.model.previousAttributes().customDataAnimations;g.processAnimations(l,i);break}});setTimeout(function(){b.checkChangeHeight(f)},50)},renderFlick:function(c){var b=new AWEContent.Collections.Flicks();b.stream=c.flickrStream;b.id=c.flickrID;b.numberPhoto=c.numberPhoto;b.numberColum=c.numberColum;b.lightbox=c.flickrPreview;return new AWEContent.Views.FlicksView({el:this.$el,collection:b})},openlightbox:function(){AWEContent.jqIframe(".awe-flickr, .awe-type-lightbox",this.el).magnificPopup({delegate:".openlightbox",type:"image",removalDelay:300,mainClass:"mfp-fade",prependTo:".awe-page-wrapper",gallery:{enabled:true,preload:[0,2],navigateByImgClick:true}})}});AWEContent.Views.FlickrItemController=AWEContent.Views.ItemController.extend({machineName:"flickr",controllerHtml:function(){return'<div class="title-icon">Flickr</div><i class="ic ac-icon-flickr"></i>'},createItemModel:function(b){var c;if(b!=undefined){c=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);b.boxModelSettings=c;return new AWEContent.Models.FlickrItem(b)}return new AWEContent.Models.FlickrItem({boxModelSettings:new AWEContent.Models.BoxModelSettings()})}});AWEContent.Views.FlickrPanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel panel-flickr",panelName:"flickr",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var b=this;a("#flickr-enter-link input",b.$el).change(function(){b.editingModel.set("flickrID",a(this).val())});a("#flickr-custom-id input",b.$el).change(function(){b.editingModel.set("customID",a(this).val())});a("#flickr-custom-class input",b.$el).change(function(){b.editingModel.set("customClass",a(this).val())});a("#flickr-stream",b.$el).change(function(d,c){b.editingModel.set("flickrStream",c.value)});a("#flickr-number-photo",this.$el).change(function(d,c){b.editingModel.set("numberPhoto",c.value)});a("#flickr-column",this.$el).change(function(d,c){b.editingModel.set("numberColum",c.value)});a("#flickr-preview",b.$el).change(function(d,c){b.editingModel.set("flickrPreview",c.value)});a("#flickr-image-margin",this.$el).change(function(d,c){b.editingModel.set("imageMargin",c.value);if(c.value==-1){a(".display-font",a(this)).text("DF")}});a("#flickr-custom-attributes",this.el).initAttributesPanel(b);a("#flickr-column-box-model",b.$el).initBoxModelPanel(b,"boxModelSettings");a("#flickr-animations",this.el).change(function(c,d){b.editingModel.set("customEnableAnimations",d.enabled);if(d){b.editingModel.set("customDataAnimations",d.animations)}})},setPanelElementsValue:function(){var b=this,c=this.editingModel.toJSON();a("#flickr-enter-link input",this.$el).val(c.flickrID);a("#flickr-custom-id input",this.$el).val(c.customID);a("#flickr-custom-class input",this.$el).val(c.customClass);a("#flickr-stream",b.$el).aweSelect("value",c.flickrStream);a("#flickr-preview",b.$el).aweSelect("value",c.flickrPreview);a("#flickr-number-photo",this.$el).aweSlider("value",c.numberPhoto);a("#flickr-column",this.$el).aweSlider("value",c.numberColum);a("#flickr-image-margin",this.$el).aweSlider("value",c.imageMargin);a("#flickr-column-box-model",this.$el).initBoxModel(c.boxModelSettings);a("#flickr-custom-attributes",this.el).initAttributes(c.customEnableAttributes,c.customDataAttributes);a("#flickr-animations",this.el).aweAnimation("value",{enabled:c.customEnableAnimations,animations:c.customDataAnimations,previewEl:b.editingModel.view.$el})},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Flickr</h2></div>'},custom_attributes:{type:"section",enter_link:{type:"text_field",title:"Flickr ID",attributes:{placeholder:""},default_value:"32738276@N08"},title:{type:"markup",markup:'<div class="small-quote"><span>To find your flickrID visit <a href="http://idgettr.com/" target="_blank">idGettr</a></span></div>'},number_photo:{type:"slider",title:"No of Img",values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],default_value:5,allow_type:true},column:{type:"slider",title:"Column",values:[1,2,3,4,5,6],default_value:3,allow_type:true},image_margin:{type:"slider",title:"Image Margin",min_value:-1,max_value:20,default_value:3,allow_type:true,unit:"px"},stream:{type:"select",title:"Stream",options:{user:"User",group:"Group"},default_value:"group"},preview:{type:"select",title:"Preview",options:{openlightbox:"Lightbox",linktoflickr:"Link to flickr"},default_value:"openlightbox"}},custom_box_model:{type:"section",column_box_model:{type:"tabs",tabs:[{tab_title:"Border",contents:{custom_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{custom_border_radius:{type:"box_model",model_type:"border_radius",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Padding",contents:{custom_padding:{type:"box_model",model_type:"padding",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Margin",contents:{custom_margin:{type:"box_model",model_type:"margin",allow_type:true,min_value:0,max_value:100,default_value:0}}}]}},custom_definitions:{type:"section",custom_id:{type:"text_field",title:"ID",attributes:{placeholder:"Custom ID"},default_value:""},custom_class:{type:"text_field",title:"CSS class",attributes:{placeholder:"Custom class"},default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}});a(document).ready(function(){AWEContent.Controllers.flickr=new AWEContent.Views.FlickrItemController();AWEContent.Panels.flickr=new AWEContent.Views.FlickrPanel()})})(jQuery);