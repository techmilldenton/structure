(function(a){AWEContent.Models.IframeItem=AWEContent.Models.Item.extend({defaults:{machine_name:"iframe",iframeUrl:"http://megadrupal.com/",height:500,boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type" : "none"}',lgResponsive:true,xsResponsive:true,mediumResponsive:true,smResponsive:true},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.IframeItem({model:this})},clone:function(){var b={};a.each(this.toJSON(),function(c,d){b[c]=d});b.boxModelSettings=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);return new AWEContent.Models.IframeItem(b)}});AWEContent.Views.IframeItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var b=this,c=b.model.toJSON(),e=a('<div class="awe-item-preload"></div><iframe class="awe-item awe-iframe" src="" width="100%"></iframe>');e.attr({src:b.processUrl(c.iframeUrl),id:c.customID}).css({height:c.height==-1?"":(c.height+"px")}).addClass(c.customClass);e.renderItemDefaultBoxModel(c.boxModelSettings);if(c.customEnableAttributes){if(c.customDataAttributes!="[]"){a.each(a.parseJSON(c.customDataAttributes),function(f,h){var g="data-"+h.attrName;var i=h.attrValue;e.attr(g,i)})}}e.renderItemDefaultAttributes(c.customEnableAttributes,c.customDataAttributes);if(c.customEnableAnimations){var d=c.customDataAnimations;e.processAnimations(d)}b.$el.defaultResponsive(c);e.load(function(){a(".awe-item-preload",b.$el).remove()});return e},applySettingsChanged:function(c){var b=this,f=a("> iframe",b.$el),d=c.toJSON(),e=b.$el.height();a.each(c.changedAttributes(),function(h,j){b.$el.changeResponsive(h,j);f.renderChangeSettingBoxModel(h,j,c);switch(h){case"iframeUrl":b.$el.prepend('<div class="awe-item-preload"></div>');f.attr("src",b.processUrl(j));break;case"height":j==-1?f.css("height",""):f.css("height",j+"px");break;case"customID":f.attr("id",j);break;case"customClass":var k=b.model.previousAttributes().customClass;f.removeClass(k).addClass(j);break;case"customEnableAttributes":f.renderChangeSettingsAttributes(h,j,d.customDataAttributes);break;case"customActionAttributes":f.renderChangeSettingsAttributes(h,j);break;case"customEnableAnimations":var i,g;if(j){i=d.customDataAnimations;g=null;f.processAnimations(i)}else{i=null;g=d.customDataAnimations;f.processAnimations(i,g)}break;case"customDataAnimations":var i,g;i=d.customDataAnimations;g=b.model.previousAttributes().customDataAnimations;f.processAnimations(i,g);break}});setTimeout(function(){b.checkChangeHeight(e)},50)},processUrl:function(b){if(b!=""){if(b.indexOf("http://")==0||b.indexOf("//")==0||b.indexOf("https://")==0){return b}else{return"http://"+b}}}});AWEContent.Views.IframeItemController=AWEContent.Views.ItemController.extend({machineName:"iframe",controllerHtml:function(){return'<div class="title-icon">iframe</div><i class="ic ac-icon-iframe"></i>'},createItemModel:function(b){var c;if(b!=undefined){c=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);b.boxModelSettings=c;return new AWEContent.Models.IframeItem(b)}return new AWEContent.Models.IframeItem({boxModelSettings:new AWEContent.Models.BoxModelSettings()})}});AWEContent.Views.IframePanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel panel-iframe",panelName:"iframe",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var b=this;a("#text-iframe-enter-link",b.el).change(function(){b.editingModel.set("iframeUrl",a(this).val())});a("#iframe-height",b.el).change(function(d,c){b.editingModel.set("height",c.value);if(c.value==-1){a(".display-font",a(this)).text("DF")}});a("#iframe-column-box-model",b.el).initBoxModelPanel(b,"boxModelSettings");a("#text-iframe-custom-id",b.el).change(function(){b.editingModel.set("customID",a(this).val())});a("#text-iframe-custom-class",b.el).change(function(){b.editingModel.set("customClass",a(this).val())});a("#iframe-custom-attributes",this.el).initAttributesPanel(b);a("#iframe-animations",this.el).change(function(c,d){b.editingModel.set("customEnableAnimations",d.enabled);if(d){b.editingModel.set("customDataAnimations",d.animations)}})},setPanelElementsValue:function(){var b=this,c=this.editingModel.toJSON();a("#text-iframe-enter-link",b.el).val(c.iframeUrl);a("#iframe-height",b.el).aweSlider("value",c.height);a("#iframe-column-box-model",b.el).initBoxModel(c.boxModelSettings);a("#text-iframe-custom-id",b.el).val(c.customID);a("#text-iframe-custom-class",b.el).val(c.customClass);a("#iframe-custom-attributes",this.el).initAttributes(c.customEnableAttributes,c.customDataAttributes);a("#iframe-animations",this.el).aweAnimation("value",{enabled:c.customEnableAnimations,animations:c.customDataAnimations,previewEl:b.editingModel.view.$el})},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Custom Iframe</h2></div>'},custom_attributes:{type:"section",enter_link:{type:"text_field",title:"Link",attributes:{placeholder:"http://..."},default_value:"http://"},height:{type:"slider",title:"Height",min_value:-1,max_value:999,default_value:300,allow_type:true,unit:"px"}},custom_box_model:{type:"section",column_box_model:{type:"tabs",tabs:[{tab_title:"Border",contents:{custom_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{custom_border_radius:{type:"box_model",model_type:"border_radius",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Padding",contents:{custom_padding:{type:"box_model",model_type:"padding",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Margin",contents:{custom_margin:{type:"box_model",model_type:"margin",allow_type:true,min_value:0,max_value:100,default_value:0}}}]}},custom_definitions:{type:"section",custom_id:{type:"text_field",title:"ID",attributes:{placeholder:"Custom ID"},default_value:""},custom_class:{type:"text_field",title:"CSS class",attributes:{placeholder:"Custom class"},default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}});a(document).ready(function(){AWEContent.Controllers.iframe=new AWEContent.Views.IframeItemController();AWEContent.Panels.iframe=new AWEContent.Views.IframePanel()})})(jQuery);