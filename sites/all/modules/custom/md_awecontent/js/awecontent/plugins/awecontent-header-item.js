(function(a){AWEContent.Models.HeaderItem=AWEContent.Models.Item.extend({defaults:{machine_name:"header",tagName:"h2",textContent:"Type your header here",fontFamily:"",fontStyle:"",textAlign:"left",fontSize:-1,lineHeight:-1,letterSpacing:-1,color:"",backgroundColor:"",boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type" : "none"}',lgResponsive:true,xsResponsive:true,mediumResponsive:true,smResponsive:true},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.HeaderItem({model:this})},clone:function(){var b={};a.each(this.toJSON(),function(c,d){b[c]=d});b.boxModelSettings=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);return new AWEContent.Models.HeaderItem(b)}});AWEContent.Views.HeaderItem=AWEContent.Views.Item.extend({additionalEvents:{},initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var c=this,b=a("<"+this.model.get("tagName")+"/>"),e=this.model.toJSON(),d={"font-family":e.fontFamily,"text-align":e.textAlign,"font-size":e.fontSize==-1?"":(e.fontSize+"px"),"line-height":e.lineHeight==-1?"":(e.lineHeight+"px"),"letter-spacing":e.letterSpacing==-1?"":(e.letterSpacing+"px"),color:e.color,"background-color":e.backgroundColor};if(e.fontStyle){d=a.extend({},d,JSON.parse(e.fontStyle))}b.html(e.textContent).addClass("awe-item awe-header").css(d).attr("id",e.customID).addClass(e.customClass).renderItemDefaultBoxModel(e.boxModelSettings);b.renderItemDefaultAttributes(e.customEnableAttributes,e.customDataAttributes);if(e.customEnableAnimations){var f=e.customDataAnimations;b.processAnimations(f)}c.iframeJQuery(this.el).delegate(c.model.get("tagName"),"itemReady",function(){var g,h;c.iframeJQuery(this).hallo({plugins:{halloformat:{formattings:{bold:true,italic:true,strikethrough:true,underline:true}}},create:function(){this.addEventListener("paste",function(i){i.preventDefault();var j=i.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",false,j)})},editable:true,activated:function(i){g=a(i.target).height()},deactivated:function(i){c.changeContent(i);h=a(i.target).height();if(h!=g){c.resizeItem()}}})});c.$el.defaultResponsive(e);return b},applySettingsChanged:function(d){var c=this,b=a(c.model.get("tagName"),c.$el),e=d.toJSON(),f=c.$el.height();a.each(d.changedAttributes(),function(j,l){c.$el.changeResponsive(j,l);b.renderChangeSettingBoxModel(j,l,d);switch(j){case"fontFamily":b.css("font-family",l);break;case"fontStyle":var m=(l)?JSON.parse(l):{"font-weight":"","font-style":""};b.css(m);break;case"textAlign":b.css("text-align",l);break;case"fontSize":l==-1?b.css("font-size",""):b.css("font-size",l+"px");break;case"lineHeight":l==-1?b.css("line-height",""):b.css("line-height",l+"px");break;case"letterSpacing":l==-1?b.css("letter-spacing",""):b.css("letter-spacing",l+"px");break;case"tagName":var n=c.model.previousAttributes().tagName,i=c.iframeJQuery(c.$el);a(n,c.$el).remove();c.$el.append(c.renderItemContent());c.iframeJQuery(l,i).hallo({plugins:{halloformat:{formattings:{bold:true,italic:true,strikethrough:true,underline:true}}},editable:true,create:function(){this.addEventListener("paste",function(o){o.preventDefault();var p=o.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",false,p)})},deactivated:function(o){c.changeContent(o)}});break;case"color":b.css("color",l);break;case"backgroundColor":b.css("background-color",l);break;case"customID":b.attr("id",l);break;case"customClass":var h=c.model.previousAttributes().customClass;b.removeClass(h).addClass(l);break;case"customEnableAttributes":b.renderChangeSettingsAttributes(j,l,e.customDataAttributes);break;case"customActionAttributes":b.renderChangeSettingsAttributes(j,l);break;case"customEnableAnimations":var k,g;if(l){k=e.customDataAnimations;g=null;b.processAnimations(k)}else{k=null;g=e.customDataAnimations;b.processAnimations(k,g)}break;case"customDataAnimations":var k,g;k=e.customDataAnimations;g=c.model.previousAttributes().customDataAnimations;b.processAnimations(k,g);break}});setTimeout(function(){c.checkChangeHeight(f)},50)},processAnimations:function(){var q=this,j=q.model.toJSON(),b=a(q.model.get("tagName"),q.$el),l=j.customEnableAnimations,d=j.customDataAnimations,n=q.model.previousAttributes().customDataAnimations,m,g,i,p,k="",o="";c(n,b);setTimeout(function(){e()},50);function f(s,t){var r="";switch(s){case"floatin":r="proty-dir-"+t;break;case"flyin":r="proty-dir-distant-"+t;break;case"turnin":r="proty-dir-turn-"+t;break}return r}function h(s){var r="";if(s!="none"){r="ant-"+s}return r}function c(w,t){var s="",u="",r,v;if(w&&w!=""){w=a.parseJSON(w);r=w.type;v=w.advance;s=h(r);u=f(r,v);t.removeClass(s+" "+u).css({"animation-duration":"","animation-delay":""});if(r=="spinin"){b.css({"-ms-transform":"","-webkit-transform":"",transform:""})}return true}return false}function e(){if(d!=""){d=a.parseJSON(d);m=d.type;g=d.duration;i=d.delay;p=d.advance;k=h(m);o=f(m,p);b.css({"animation-duration":g+"ms","animation-delay":i+"ms"});if(m=="spinin"){var r=360*parseInt(p.numberOfSpin);r=p.direction=="clockwise"?(-r):r;r="rotate("+r+"deg)";b.css({"-ms-transform":r,"-webkit-transform":r,transform:r})}b.addClass(k+" "+o)}}},changeContent:function(c){var b=a(c.currentTarget).html();this.model.set("textContent",b)}});AWEContent.Views.HeaderItemController=AWEContent.Views.ItemController.extend({machineName:"header",controllerHtml:function(){return'<div class="title-icon">Header</div><i class="ic ac-icon-header"></i>'},createItemModel:function(b){var c;if(b!=undefined){c=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);b.boxModelSettings=c;return new AWEContent.Models.HeaderItem(b)}return new AWEContent.Models.HeaderItem({boxModelSettings:new AWEContent.Models.BoxModelSettings()})}});AWEContent.Views.HeaderPanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel header-panel",panelName:"header",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var b=this;a("#header-font",this.$el).bind("fontFamilyChange",function(d,c){b.editingModel.set("fontFamily",c)}).bind("fontStyleChange",function(c,d){b.editingModel.set("fontStyle",d.value)}).bind("textAlignChange",function(d,c){b.editingModel.set("textAlign",c.value)}).bind("fontSizeChange",function(c,d){b.editingModel.set("fontSize",d.value)}).bind("letterSpacingChange",function(c,d){b.editingModel.set("letterSpacing",d.value)}).bind("lineHeightChange",function(d,c){b.editingModel.set("lineHeight",c.value)});a("#header-tag",this.el).change(function(d,c){b.editingModel.set("tagName",c.value.toLowerCase())});a("#header-text-color",this.el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("color",c)});a("#header-background-color",this.el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("backgroundColor",c)});a("#header-layout-tab",this.el).initBoxModelPanel(this,"boxModelSettings");a("#text-header-custom-id",this.el).change(function(){b.editingModel.set("customID",a(this).val())});a("#text-header-custom-classes",this.el).change(function(){b.editingModel.set("customClass",a(this).val())});a("#header-custom-attributes",this.el).initAttributesPanel(b);a("#header-animations",this.el).change(function(c,d){b.editingModel.set("customEnableAnimations",d.enabled);if(d){b.editingModel.set("customDataAnimations",d.animations)}})},setPanelElementsValue:function(){var b=this.editingModel.toJSON();a("#header-font",this.$el).aweFont("options",{fontFamily:b.fontFamily,fontStyle:b.fontStyle,fontSize:b.fontSize,textAlign:b.textAlign,lineHeight:b.lineHeight,letterSpacing:b.letterSpacing});a("#header-tag",this.$el).aweSlider("value",b.tagName.toUpperCase());a("#header-text-color",this.el).aweColorPicker("value",b.color);a("#header-background-color",this.el).aweColorPicker("value",b.backgroundColor);a("#header-layout-tab",this.el).initBoxModel(b.boxModelSettings);a("#text-header-custom-id",this.el).val(b.customID);a("#text-header-custom-classes",this.el).val(b.customClass);a("#header-custom-attributes",this.el).initAttributes(b.customEnableAttributes,b.customDataAttributes);a("#header-animations",this.el).aweAnimation("value",{enabled:b.customEnableAnimations,animations:b.customDataAnimations,previewEl:this.editingModel.view.$el})},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Header</h2></div>'},font_settings:{type:"section",font:{type:"font"}},header_tag:{type:"section",tag:{type:"slider",title:"Heading tag",values:["H1","H2","H3","H4","H5","H6"],default_value:"H2",allow_type:false}},color_settings:{type:"section",text_color:{type:"colorpicker",title:"Color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}},background_color:{type:"colorpicker",title:"Background Color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}}},box_settings:{type:"section",layout_tab:{type:"tabs",tabs:[{tab_title:"Border",contents:{header_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{header_boder_radius:{type:"box_model",model_type:"border_radius",min_value:0,max_value:100,allow_type:true}}},{tab_title:"Padding",contents:{header_padding:{type:"box_model",model_type:"padding",allow_type:true,min_value:0,max_value:100}}},{tab_title:"Margin",contents:{header_margin:{type:"box_model",model_type:"margin",allow_type:true,min_value:0,max_value:100}}}]}},others:{type:"section",custom_id:{type:"text_field",title:"ID",default_value:"ID"},custom_classes:{type:"text_field",title:"Classes",default_value:"className"},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}});a(document).ready(function(){AWEContent.Controllers.header=new AWEContent.Views.HeaderItemController();AWEContent.Panels.header=new AWEContent.Views.HeaderPanel()})})(jQuery);