(function(a){AWEContent.Models.ImageSlide=Backbone.RelationalModel.extend({defaults:{fid:-1,srcImageStyle:"",srcThumbStyle:"",linkImage:"",captionImage:"",enableCaption:0,captionPosition:"top",targetImage:1},createView:function(){this.view=new AWEContent.Views.ImageSlide({model:this})},getView:function(){return this.view}});AWEContent.Views.ImageSlide=Backbone.View.extend({tagName:"div",className:"md-item-image",events:{"click .awe-box-btn":"changeContent","click .edit-link":"editLink","click .edit-caption":"editCaption","click .remove-image":"destroyImage"},template:_.template('<div class="awe-image-item">                <% if (linkImage) { %>                <a class="mgf-md-popup" target="<%= targetImage %>" href="<%= linkImage %>">                <% } %>                <div class="awe-image-content">                    <div class="awe-image-container"><img src="<%= srcImage %>" alt=""></div>                    <div class="awe-image-caption"><%= captionImage %></div>                </div>                <% if (linkImage) { %>                </a>                <% } %>                <div class="awe-image-control">                    <ul>                        <li class="edit-link">                            <i class="ic ac-icon-link"></i>                            <div class="awe-control-box">                                <div class="awe-box-header">Image link</div>                                <div class="awe-box-content">                                    <div class="awe-box-item"><textarea></textarea></div>                                    <div class="awe-box-item">                                        <input type="checkbox" name="target" id="ckb-target" class="ckb-target">                                        <label for="ckb-target" class="label-checkbox">Open new window</label>                                    </div>                                </div>                                <div class="awe-box-footer">                                    <a href="#" class="awe-box-btn js-ok">Save</a>                                    <a href="#" class="awe-box-btn js-cancel">Cancel</a>                                </div>                            </div>                        </li>                        <li class="edit-caption">                            <i class="ic ac-icon-caption"></i>                            <div class="awe-control-box">                                <div class="awe-box-header">Image caption</div>                                 <div class="awe-box-content">                                    <div class="awe-box-item">                                        <textarea></textarea>                                    </div>                                </div>                                <div class="awe-box-footer">                                    <a href="#" class="awe-box-btn js-ok">Save</a>                                    <a href="#" class="awe-box-btn js-cancel">Cancel</a>                                </div>                            </div>                        </li>                        <li class="remove-image"><i class="ic ac-icon-trash"></i></li>                    </ul>                </div>            </div>'),initialize:function(){this.render();this.$el.delegate(".awe-control-box","click",function(b){b.stopPropagation()});this.listenTo(this.model,"change",this.changeSettings)},render:function(){var c=this,d=c.model.toJSON(),b=d.srcThumbStyle;c.$el.append(c.template({captionImage:d.captionImage,targetImage:"_blank",linkImage:d.linkImage,srcImage:d.srcImageStyle}));c.$img=a("img",c.el);c.$img.data("srcThumbStyle",b);if(d.enableCaption==0){a("li.edit-caption",c.$el).hide()}if(d.captionPosition=="top"){a(".awe-image-content",c.$el).prepend(a(".awe-image-caption",c.el))}else{if(d.captionPosition=="over"){c.$el.addClass("position-over");c.addImageOverlay()}}return c.$el},changeSettings:function(c){var b=this,d=a(".mgf-md-popup",b.el),f=a(".awe-image-caption",b.el),e=a(".awe-image-content",b.el);a.each(c.changedAttributes(),function(g,h){switch(g){case"srcImageStyle":b.$img.attr("src",h);break;case"srcThumbStyle":b.$img.data("srcThumbStyle",h).trigger("change",{action:"changeThumbnail"});break;case"linkImage":if(h!=""){a(".awe-image-item",b.$el).prepend(a('<a target="_blank"></a>').attr("href",h));a(".awe-image-item > a",b.$el).append(a(".awe-image-content",b.$el))}else{if(c.previousAttributes().linkImage!=""){a(".awe-image-item",b.$el).prepend(a(".awe-image-content",b.$el));a(".awe-image-item > a",b.$el).remove()}}break;case"targetImage":if(b.model.get("linkImage")){var i="_blank";d.attr("target",i)}break;case"enableCaption":h?a(".awe-image-caption",b.$el).show():a(".awe-image-caption",b.$el).hide();b.removeImageOverlay();if(h&&b.model.get("captionImage")&&b.model.get("captionPosition")=="over"){b.addImageOverlay()}break;case"captionImage":a(".awe-image-caption",b.$el).html(h);break;case"captionPosition":b.$el.removeClass("position-over");switch(h){case"top":b.removeImageOverlay();e.prepend(f);break;case"bottom":b.removeImageOverlay();e.append(f);break;case"over":b.addImageOverlay();b.$el.addClass("position-over");break}break}})},addCaption:function(){var b=this,c=b.model.get("captionImage"),d=b.model.get("captionPosition"),e=a('<div class="awe-image-caption"></div>').html(c);if(d=="bottom"){a(".awe-image-content",b.$el).append(e)}else{a(".awe-image-content",b.$el).prepend(e);if(d=="over"){b.$el.addClass("position-over");b.addImageOverlay()}}},changeContent:function(f){f.preventDefault();f.stopPropagation();var c=this,b=a(f.target),g=b.closest("li.active"),e=a("textarea",g).val();g.removeClass("active");if(b.hasClass("js-ok")){if(g.hasClass("edit-link")){var d=a(".ckb-target",g).prop("checked");c.model.set("linkImage",e);c.model.set("targetImage",d?1:0)}else{if(g.hasClass("edit-caption")){c.model.set("captionImage",e)}}}},editLink:function(d){d.stopPropagation();d.preventDefault();var c=this,f=c.model.get("linkImage"),b=a(d.target).hasClass("edit-link")?a(d.target):a(d.target).closest(".edit-link"),e=a("textarea",b);b.siblings("li").removeClass("active");b.toggleClass("active");e.val(f)},editCaption:function(d){d.stopPropagation();d.preventDefault();var c=this,f=c.model.get("captionImage"),b=a(d.target).hasClass("edit-caption")?a(d.target):a(d.target).closest(".edit-caption"),e=a("textarea",b);b.siblings("li").removeClass("active");b.toggleClass("active");e.val(f)},destroyImage:function(){if(this.$el.closest(".owl-wrapper").children().length>1){this.model.destroy();this.$el.remove()}},addImageOverlay:function(){a(".awe-image-content",this.$el).prepend('<div class="awe-image-overlay"></div>')},removeImageOverlay:function(){a(".awe-image-overlay",this.$el).remove()}});AWEContent.Collections.ListImageSlide=Backbone.Collection.extend({model:AWEContent.Models.ImageSlide});AWEContent.Views.ListImageSlide=Backbone.View.extend({tagName:"div",className:"",events:{},initialize:function(){this.listenTo(this.collection,"add",this.addImage);this.listenTo(this.collection,"destroy",this.removeImage);this.render()},render:function(){var b=this;b.collection.each(function(d,c){d.createView();b.$el.append(d.getView().$el)})},addImage:function(b,c){b.createView();this.$el.append(b.getView().$el)}});AWEContent.Models.SlideShowItem=AWEContent.Models.Item.extend({defaults:{machine_name:"slideshow",images:[],styleImage:"none",effectSlide:"fade",nav:"none",styleThumb:"ac_slide_thumb_default",positionThumb:"bottom",showControls:0,stopOnHoverSlide:0,autoPlay:0,speedImage:4000,transSpeed:400,caption:0,captionColor:"",captionPosition:"top",captionOnHover:0,imageBgOverlay:"",boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[]",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:1,customDataAnimations:'{"type" : "none"}',lgResponsive:true,xsResponsive:true,mediumResponsive:true,smResponsive:true},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings},{type:Backbone.HasMany,key:"images",relatedModel:AWEContent.Models.ImageSlide,relatedCollection:AWEContent.Collections.ListImageSlide}],createView:function(){this.view=new AWEContent.Views.SlideShowItem({model:this})},clone:function(){var c={},b=new AWEContent.Collections.ListImageSlide();this.get("images").each(function(d,e){b.add(d.clone())});a.each(this.toJSON(),function(d,e){if(d!="images"){c[d]=e}});c.images=b;c.boxModelSettings=new AWEContent.Models.BoxModelSettings(c.boxModelSettings);return new AWEContent.Models.SlideShowItem(c)}});AWEContent.Views.SlideShowItem=AWEContent.Views.Item.extend({additionalEvents:{},refreshGidImage:function(){if(AWEContent.Panels.slideshow.isOpenned){AWEContent.Panels.slideshow.setPanelElementsValue()}},initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);var b=this;this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged);this.listenTo(this.model.get("images"),"add",this.addImage);this.listenTo(this.model.get("images"),"remove",this.removeImage);this.listenTo(this.model.get("images"),"change:srcImage",this.changeThumbImage);this.$el.resize(function(){b.owlSlide.data("owlCarousel").reinit(b.settingsOwl);b.owlThumb.data("owlCarousel").reinit(b.stOwlThumb)});b.iframeJQuery(this.el).delegate(".awe-slideshow","itemReady",function(){b.$el.delegate(".mgf-md-popup img","change",function(h,g){if(g.action=="changeThumbnail"){var f=a(this),i=f.data("srcThumbStyle"),d=f.closest(".owl-item").length?f.closest(".owl-item"):f.closest(".md-item-image"),e=d.index(),j=b.$listThumb.find(".image-thumb img").eq(e);j.attr("src",i);a.imageLoaded({src:i},function(){if(status.err){return}})}});if(b.model.toJSON().nav=="thumbnail"){b.$el.find(".mgf-md-popup img").each(function(){a(this).trigger("change",{action:"changeThumbnail"})})}});this.$el.bind("getImagesStyleSuccess",function(j,i,e){var g=(i=="styleImage")?"srcImageStyle":"srcThumbStyle",h=b.model.get(i),d=AWEContent.jqIframe('<div class="owl-list-thumb"><div class="list-thumb-content"></div></div>');b.model.get("images").each(function(m){var n=m.get("fid"),l=e[n][h];m.set(g,l);if(i=="styleThumb"){var k=a('<div class="image-thumb"><img src="" alt=""/></div>');a("img",k).attr("src",l);a(".list-thumb-content",d).append(k)}});if(i=="styleThumb"){b.$listThumb=d;b.thumbWidthLoaded=false;b.getThumbImageSize();var f=setInterval(function(){if(b.thumbWidthLoaded){clearInterval(f);b.initThumbList();if(b.model.get("nav")=="thumbnail"){a(".owl-list-thumb",b.$el).remove();if(b.model.get("positionThumb")=="bottom"){a(".awe-slideshow",b.$el).append(b.$listThumb)}else{a(".awe-slideshow",b.$el).prepend(b.$listThumb)}}}},100)}});var c;a(window).resize(function(d){if(c){clearInterval(c)}c=setTimeout(function(){b.initThumbList()},100)})},resizeImage:function(b){var d=0,c=setInterval(function(){d++;if(d>20){clearInterval(c)}else{if(b.width()>0){clearInterval(c);setTimeout(function(){b.css({width:"",height:""});var g=b.width(),e=b.height(),f=0.5;if((e/g)>=f){g="100%";e="auto"}else{g="auto";e="100%"}b.css({width:g,height:e})},100)}}},50)},changeThumbImage:function(c,f){var b=c.view.$el.parent().index(),d=this.$listThumb,e=a("img",d).eq(b);e.attr("src",f)},renderItemContent:function(){var d=this,e=d.model.toJSON(),b=d.model.get("images"),f=a('<div class="awe-item awe-slideshow"></div>'),c=new AWEContent.Views.ListImageSlide({collection:b});f.append(c.$el.addClass("image-slide-show"));b.each(function(g){g.set("captionPosition",e.captionPosition)});d.renderThumbList();d.getThumbImageSize();AWEContent.Library.addLibrary("owlCarousel",function(){if(b.length){var g=setInterval(function(){if(a(".awe-slideshow",d.el).length&&d.thumbWidthLoaded){clearInterval(g);if(a(".awe-image-content",d.el).length){d.readyOwlCarousel()}}},50)}else{f.append("<div class='alert alert-danger'>Please drag image for here!</div>")}});if(!e.caption){f.addClass("disable-caption")}if(e.captionPosition=="top"){a(".owl-item .awe-image-content",f).each(function(){a(this).prepend(a(".awe-image-caption",a(this)))})}else{if(e.captionPosition=="over"){a(".awe-image-content",f).prepend(a('<div class="awe-image-overlay" />').css("background-color",e.imageBgOverlay));a(".awe-image-overlay",f).css("background-color",e.imageBgOverlay);if(e.onHover){f.addClass("caption-hover")}}}f.attr("id",e.customID).addClass(e.customClass).renderItemDefaultBoxModel(e.boxModelSettings);f.renderItemDefaultAttributes(e.customEnableAttributes,e.customDataAttributes);a(".awe-image-caption",f).css("color",e.captionColor);if(e.captionOnHover){f.addClass("caption-hover")}if(e.customEnableAnimations){f.processAnimations(e.customDataAnimations)}d.$el.defaultResponsive(e);f.aweDragUpload({multiUpload:true,uploadSuccessCallback:function(i,g){if(i.status&&i.file){var o=d.model.get("images"),h=i.file.fid,k=d.model.toJSON().styleThumb,m=d.model.toJSON().styleImage,n=k+","+m,j=i.file.file_url;if(AWEContent.Path.imageStyleURL!=""){a.post(AWEContent.Path.imageStyleURL,{fids:""+h,styles:n},function(s){if(a.type(s)=="string"){s=JSON.parse(s.trim())}var r={fid:h,srcThumbStyle:s[h][d.model.get("styleThumb")],srcImageStyle:s[h][d.model.get("styleImage")],captionPosition:d.model.get("captionPosition"),enableLightBox:d.model.get("enableLightBox")};if(d.model.get("createFromDefault")==true){d.model.get("images").at(0).set(r);d.model.set("createFromDefault",false);d.model.view.getImageStyleURL("styleThumb")}else{var q=new AWEContent.Models.ImageSlide(r);o.add(q);d.refreshGidImage()}})}else{var p={fid:h,srcThumbStyle:j,srcImageStyle:j,captionPosition:d.model.get("captionPosition"),enableLightBox:d.model.get("enableLightBox")};if(d.model.get("createFromDefault")==true){d.model.get("images").at(0).set(p);d.model.set("createFromDefault",false)}else{var l=new AWEContent.Models.ImageSlide(p);o.add(l);d.refreshGidImage()}}}}});return f},readyOwlCarousel:function(c){var e=this,g=e.model.toJSON();if(c){e.settingsOwl=c}else{var d=false,h=false,f=false;if(g.nav=="none"||g.nav=="thumbnail"){d=false}else{if(g.nav=="button"){d=true;h=false}else{d=true;h=true}}if(g.autoPlay){f=g.speedImage}else{f=false}e.settingsOwl={singleItem:true,autoPlay:false,stopOnHover:false,pagination:d,paginationNumbers:h,navigation:g.showControls?true:false,addClassActive:true,transitionStyle:g.effectSlide,beforeMove:function(){e.owlSlide.find(".active").css({duration:""})},afterMove:function(){var j=e.model.get("transSpeed");e.owlSlide.find(".active").css({"animation-duration":j+"ms"})},afterAction:i}}e.initThumbList();if(g.nav=="thumbnail"){if(g.positionThumb=="top"){a(".awe-slideshow",e.el).prepend(e.$listThumb)}else{a(".awe-slideshow",e.el).append(e.$listThumb)}}e.owlSlide=AWEContent.jqIframe(".image-slide-show",e.el);e.owlSlide.owlCarousel(e.settingsOwl);function i(j){var k=this.currentItem;e.owlThumb.find(".owl-item").removeClass("synced").eq(k).addClass("synced");if(e.owlThumb.data("owlCarousel")!==undefined){b(k)}}e.$el.delegate(".owl-item","click",function(k){k.preventDefault();var j=AWEContent.jqIframe(this).data("owlItem");e.owlSlide.data("owlCarousel").goTo(j)});function b(l){var n=e.owlThumb.data("owlCarousel").owl.visibleItems,j=l,m=false;for(var k in n){if(j===n[k]){m=true}}if(m===false){if(j>n[n.length-1]){e.owlThumb.trigger("owl.goTo",j-n.length+2)}else{if(j-1===-1){j=0}e.owlThumb.trigger("owl.goTo",j)}}else{if(j===n[n.length-1]){e.owlThumb.trigger("owl.goTo",n[1])}else{if(j===n[0]){e.owlThumb.trigger("owl.goTo",j-1)}}}}setTimeout(function(){e.resizeItem()},100)},renderThumbList:function(){var b=AWEContent.jqIframe('<div class="owl-list-thumb"><div class="list-thumb-content"></div></div>');this.model.get("images").each(function(e){var d=e.get("srcThumbStyle"),c=a('<div class="image-thumb"><img src="" alt=""/></div>');a("img",c).attr("src",d);a(".list-thumb-content",b).append(c)});this.$listThumb=b},initThumbList:function(){var c=Math.floor(this.$el.width()/this.thumbWidth),e,b,d;if(c>this.model.get("images").length){c=this.model.get("images").length}if(c<2){c=2;e="";b=""}else{e=c*this.thumbWidth;b=(this.$el.width()-e)/2}this.stOwlThumb={pagination:false,items:c,itemsDesktop:false,itemsDesktopSmall:false,itemsTablet:false,itemsMobile:false,responsiveRefreshRate:100,afterInit:function(f){f.find(".owl-item").eq(0).addClass("synced")}};if(this.owlThumb){d=this.owlThumb.data("owlCarousel");if(d){d.destroy()}}this.owlThumb=AWEContent.jqIframe(".list-thumb-content",this.$listThumb).width(e).css("margin-left",b);this.owlThumb.owlCarousel(this.stOwlThumb)},getImageStyleURL:function(e){var b=this,d=[],c=this.model.get(e);this.model.get("images").each(function(f){d.push(f.get("fid"))});if(d.length){a.post(AWEContent.Path.imageStyleURL,{fids:d.join(","),styles:c},function(f){if(a.type(f)=="string"){f=JSON.parse(f.trim())}b.$el.trigger("getImagesStyleSuccess",[e,f])})}},applySettingsChanged:function(d){var c=this,e=d.toJSON(),b=c.model.get("images"),g=a(".awe-slideshow",c.el),f=c.$el.height();a.each(d.changedAttributes(),function(k,m){c.$el.changeResponsive(k,m);g.renderChangeSettingBoxModel(k,m,d);switch(k){case"styleImage":case"styleThumb":c.getImageStyleURL(k);break;case"effectSlide":c.settingsOwl.transitionStyle=m;c.owlSlide.data("owlCarousel").reinit(c.settingsOwl);break;case"nav":if(m=="thumbnail"){c.getThumbImageSize();var j=setInterval(function(){if(c.thumbWidthLoaded){clearInterval(j);c.renderThumbList();c.initThumbList();if(e.positionThumb=="top"){g.prepend(c.$listThumb)}else{g.append(c.$listThumb)}}},100);c.settingsOwl.pagination=false;c.settingsOwl.paginationNumbers=false}else{if(a(".owl-list-thumb",c.el).length){a(".owl-list-thumb",c.el).remove()}if(m=="none"){c.settingsOwl.pagination=false;c.settingsOwl.paginationNumbers=false}else{if(m=="number"){c.settingsOwl.pagination=true;c.settingsOwl.paginationNumbers=true}else{if(m=="button"){c.settingsOwl.pagination=true;c.settingsOwl.paginationNumbers=false}}}}c.owlSlide.data("owlCarousel").reinit(c.settingsOwl);break;case"positionThumb":if(m=="top"){g.prepend(c.$listThumb)}else{if(m=="bottom"){g.append(c.$listThumb)}}break;case"showControls":var h=m?true:false;c.settingsOwl.navigation=h;c.owlSlide.data("owlCarousel").reinit(c.settingsOwl);break;case"autoPlay":break;case"stopOnHoverSlide":break;case"speedImage":break;case"transSpeed":break;case"caption":b.each(function(o){o.set("enableCaption",m)});if(m){g.removeClass("disable-caption");a(".edit-caption",g).show();if(e.captionPosition=="over"){a(".awe-image-overlay",c.$el).css("background-color",e.imageBgOverlay)}}else{g.addClass("disable-caption");a(".edit-caption",g).hide()}break;case"captionColor":a(".awe-image-caption",g).css("color",m);break;case"captionPosition":b.each(function(o){o.set("captionPosition",m)});if(m!="over"){g.removeClass("caption-hover")}else{a(".awe-image-overlay",c.$el).css("background-color",e.imageBgOverlay);if(e.captionOnHover){g.addClass("caption-hover")}}break;case"captionOnHover":if(m&&e.captionPosition=="over"){g.addClass("caption-hover")}else{g.removeClass("caption-hover")}break;case"imageBgOverlay":a(".owl-item .awe-image-content > .awe-image-overlay",c.$el).css("background-color",m);break;case"customID":g.attr("id",m);break;case"customClass":var n=c.model.previousAttributes().classGallery;g.removeClass(n).addClass(m);break;case"customEnableAttributes":g.renderChangeSettingsAttributes(k,m,e.customDataAttributes);break;case"customActionAttributes":g.renderChangeSettingsAttributes(k,m);break;case"customEnableAnimations":var l,i;if(m){l=e.customDataAnimations;i=null;g.processAnimations(l)}else{l=null;i=e.customDataAnimations;g.processAnimations(l,i)}break;case"customDataAnimations":var l,i;l=e.customDataAnimations;i=c.model.previousAttributes().customDataAnimations;g.processAnimations(l,i);break}});setTimeout(function(){c.checkChangeHeight(f)},100)},addImage:function(e,f,d){var c=this,b=a('<div class="image-thumb"><img src="" alt=""></div>');a("img",b).attr("src",e.get("srcThumbStyle"));if(this.model.toJSON().images.length<2){c.$listThumb.append(b);a(".alert.alert-danger",c.el).remove();this.readyOwlCarousel()}else{c.owlSlide.data("owlCarousel").addItem(e.view.$el);c.owlThumb.data("owlCarousel").addItem(b);c.$el.find(".mgf-md-popup img").eq(f.length-1).trigger("change",{action:"changeThumbnail"})}c.initThumbList();c.resizeItem()},removeImage:function(d,e){var c=this,b=d.view.$el.parent(".owl-item").index();c.owlSlide.data("owlCarousel").removeItem(b);c.owlThumb.data("owlCarousel").removeItem(b);AWEContent.Panels.slideshow.setPanelElementsValue();c.resizeItem()},getThumbImageSize:function(){var b=this,e=this.model.get("styleThumb")!="none",c=this.model.get("images").at(0).get("srcThumbStyle"),d=a('<img class="awe-test-image" src="" alt="" />').attr("src",c).css({opacity:0,visibility:"hidden"});b.thumbWidthLoaded=false;if(e&&e!="none"){d.load(function(){b.thumbWidth=this.naturalWidth;a(".awe-test-image").remove();b.thumbWidthLoaded=true});a("body").append(d)}else{b.thumbWidth=150;b.thumbWidthLoaded=true}}});AWEContent.Views.SlideShowController=AWEContent.Views.ItemController.extend({machineName:"slideshow",controllerHtml:function(){return'<div class="title-icon">Slideshow</div><i class="ic ac-icon-slideshow"></i>'},createItemModel:function(d){var f;if(d!=undefined){var b;f=new AWEContent.Models.BoxModelSettings(d.boxModelSettings);b=new AWEContent.Collections.ListImageSlide(d.images);d.boxModelSettings=f;d.images=b;d.createFromDefault=false;return new AWEContent.Models.SlideShowItem(d)}else{f=new AWEContent.Models.BoxModelSettings();var e=new AWEContent.Models.ImageSlide({srcImageStyle:AWEContent.Path.defaultImage,srcThumbStyle:AWEContent.Path.defaultImage}),c=new AWEContent.Collections.ListImageSlide([e]);return new AWEContent.Models.SlideShowItem({boxModelSettings:f,images:c,createFromDefault:true})}}});AWEContent.Views.SlideShowPanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel slideshow-panel",panelName:"slideshow",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var b=this;a("#slideshow-select-image .control-gallery input[name=selected_media]",b.el).change(function(){var f=a(this).val(),k='<div class="book-lib"><i class="ic ac-icon-done"></i><img src="" alt="book"><input type="hidden" name="selected_media"/></div>',i="",m=false;try{i=a.parseJSON(f)}catch(g){}if(typeof i=="object"){var d=a("#slideshow-select-image .library",b.el),h=b.editingModel.get("styleImage"),j=b.editingModel.get("styleThumb"),l=h+","+j,c=[];a.each(i,function(){c.push(this.fid)});if(AWEContent.Path.imageStyleURL!=""){a.post(AWEContent.Path.imageStyleURL,{fids:c.join(","),styles:l},function(n){if(a.type(n)=="string"){try{n=JSON.parse(n)}catch(o){}}if(typeof(n)=="object"){a.each(i,function(){var r=this,p={fid:r.fid,srcThumbStyle:n[r.fid][b.editingModel.get("styleThumb")],srcImageStyle:n[r.fid][b.editingModel.get("styleImage")],captionPosition:b.editingModel.get("captionPosition"),enableLightBox:b.editingModel.get("enableLightBox")};if(!b.editingModel.get("images").length&&b.editingModel.get("createFromDefault")){b.editingModel.set("createFromDefault",false)}if(b.editingModel.get("createFromDefault")){b.editingModel.set("createFromDefault",false);b.editingModel.get("images").at(0).set(p);a("img",d).eq(0).attr("src",r.file_url);m=true}else{var e=new AWEContent.Models.ImageSlide(p),q=a(k);a("img",q).attr("src",r.file_url);d.append(q);b.editingModel.get("images").add(e)}});if(m){b.editingModel.view.getImageStyleURL("styleThumb")}}})}else{a.each(i,function(){var p=this,n={fid:p.fid,srcThumbStyle:p.file_url,srcImageStyle:p.file_url,captionPosition:b.editingModel.get("captionPosition"),enableLightBox:b.editingModel.get("enableLightBox")};if(!b.editingModel.get("images").length&&b.editingModel.get("createFromDefault")){b.editingModel.set("createFromDefault",false)}if(b.editingModel.get("createFromDefault")){b.editingModel.set("createFromDefault",false);b.editingModel.get("images").at(0).set(n);a("img",d).eq(0).attr("src",p.file_url)}else{var e=new AWEContent.Models.ImageSlide(n),o=a(k);a("img",o).attr("src",p.file_url);d.append(o);b.editingModel.get("images").add(e)}})}}});a("#slideshow-select-image",b.el).delegate(".book-lib input[name=selected_media]","change",function(){var f=a(this).closest(".book-lib"),e=f.index(),d=b.editingModel.get("images").at(e),c=b.editingModel.get("styleImage"),g=b.editingModel.get("styleThumb"),h=c+","+g,i=a.parseJSON(a(this).val().trim());if(i){if(AWEContent.Path.imageStyleURL!=""){a.post(AWEContent.Path.imageStyleURL,{fids:""+i.fid,styles:h},function(j){d.set({fid:i.fid,srcThumbStyle:j[i.fid][b.editingModel.get("styleThumb")],srcImageStyle:j[i.fid][b.editingModel.get("styleImage")]})})}else{d.set({fid:i.fid,srcThumbStyle:i.file_url,srcImageStyle:i.file_url})}a("img",f).attr("src",i.file_url);if(b.editingModel.get("createFromDefault")){b.editingModel.set("createFromDefault",false)}}});a("li[data-value=none]",a("#slideshow-style-thumbnail",this.el)).remove();a("#slideshow-style-thumbnail",this.el).change(function(d,c){b.editingModel.set("styleThumb",c.value)});a("#slideshow-style-image",this.el).change(function(d,c){b.editingModel.set("styleImage",c.value)});a("#slideshow-effect",this.el).change(function(d,c){b.editingModel.set("effectSlide",c.value)});a("#slideshow-navigation",this.el).change(function(d,c){b.editingModel.set("nav",c.value);if(c.value=="thumbnail"){a("#slideshow-style-thumbnail, #slideshow-position-thumbnail, .slideshow-thumb-style-title",b.el).show()}else{a("#slideshow-style-thumbnail, #slideshow-position-thumbnail, .slideshow-thumb-style-title",b.el).hide()}});a("#slideshow-position-thumbnail",this.el).change(function(d,c){b.editingModel.set("positionThumb",c.value)});a("#slideshow-show-control input[name=toggle_value]",this.el).change(function(d,c){if(!c){b.editingModel.set("showControls",parseInt(a(this).val()))}});a("#slideshow-stop-on-hover input[name=toggle_value]",this.el).change(function(d,c){if(!c){b.editingModel.set("stopOnHoverSlide",parseInt(a(this).val()))}});a("#slideshow-autoplay input[name=toggle_value]",this.el).change(function(d,c){if(!c){b.editingModel.set("autoPlay",parseInt(a(this).val()))}if(parseInt(a(this).val())){a("#slideshow-stop-on-hover, #slideshow-speed, #slideshow-trans-speed",b.el).show()}else{a("#slideshow-stop-on-hover, #slideshow-speed, #slideshow-trans-speed",b.el).hide()}});a("#slideshow-speed",this.el).change(function(d,c){b.editingModel.set("speedImage",c.value)});a("#slideshow-trans-speed",this.el).change(function(d,c){b.editingModel.set("transSpeed",c.value)});a("#slideshow-enable-caption input[name=toggle_value]",this.el).change(function(d,c){if(!c){b.editingModel.set("caption",parseInt(a(this).val()))}a("#slideshow-image-bg-overlay, #slideshow-position-caption, #slideshow-on-hover, #slideshow-caption-color",b.el).hide();if(parseInt(a(this).val())){a("#slideshow-position-caption, #slideshow-caption-color",b.el).show();if(b.editingModel.get("captionPosition")=="over"){a("#slideshow-image-bg-overlay, #slideshow-on-hover",b.el).show()}}});a("#slideshow-caption-color",b.el).change(function(d,c){c=c?c.toRgbString():"";b.editingModel.set("captionColor",c)});a("#slideshow-position-caption",this.el).change(function(d,c){b.editingModel.set("captionPosition",c.value);a("#slideshow-on-hover, #slideshow-image-bg-overlay",b.el).hide();if(b.editingModel.get("captionPosition")=="over"){a("#slideshow-on-hover, #slideshow-image-bg-overlay",b.el).show()}});a("#slideshow-on-hover input[name=toggle_value]",this.el).change(function(d,c){if(!c){b.editingModel.set("captionOnHover",parseInt(a(this).val()))}});a("#slideshow-image-bg-overlay",b.el).change(function(d,c){c=c?c.toRgbString():"";b.editingModel.set("imageBgOverlay",c)});a("#slideshow-layout-tab",b.el).initBoxModelPanel(b,"boxModelSettings");a("#text-slideshow-custom-id",this.el).change(function(){b.editingModel.set("customID",a(this).val())});a("#text-slideshow-custom-classes",this.el).change(function(){b.editingModel.set("customClass",a(this).val())});a("#slideshow-custom-attributes",this.el).initAttributesPanel(b);a("#slideshow-animations",this.el).change(function(c,d){b.editingModel.set("customEnableAnimations",d.enabled);if(d){b.editingModel.set("customDataAnimations",d.animations)}})},setPanelElementsValue:function(){var b=this,d=this.editingModel.toJSON(),c='<div class="book-lib"><i class="ic ac-icon-done"></i><img src="" alt="book"><input type="hidden" name="selected_media"/></div>',e=a("#slideshow-select-image .library",b.el);e.empty();a.each(d.images,function(f,g){var h=a(c);a("img",h).attr("src",g.srcImageStyle);e.append(h)});if(AWEContent.Path.imageStyleURL!=""){a("#slideshow-style-image",b.el).aweSelect("value",d.styleImage);a("#slideshow-style-thumbnail",b.el).aweSelect("value",d.styleThumb)}else{a("#slideshow-style-image, #slideshow-style-thumbnail",b.el).remove()}a("#slideshow-effect",b.el).aweSelect("value",d.effectSlide);a("#slideshow-navigation",b.el).aweSelect("value",d.nav);a("#slideshow-position-thumbnail",b.el).aweSelect("value",d.positionThumb);a("#slideshow-show-control input[name=toggle_value]",b.el).val(d.showControls).trigger("change",true);a("#slideshow-stop-on-hover input[name=toggle_value]",b.el).val(d.stopOnHoverSlide).trigger("change",true);a("#slideshow-autoplay input[name=toggle_value]",b.el).val(d.autoPlay).trigger("change",true);a("#slideshow-speed",this.el).aweSlider("value",d.speedImage);a("#slideshow-trans-speed",this.el).aweSlider("value",d.transSpeed);a("#slideshow-enable-caption input[name=toggle_value]",b.el).val(d.caption).trigger("change",true);a("#slideshow-caption-color",b.el).aweColorPicker("value",d.captionColor);a("#slideshow-position-caption",b.el).aweSelect("value",d.captionPosition);a("#slideshow-on-hover input[name=toggle_value]",b.el).val(d.captionOnHover).trigger("change",true);a("#slideshow-image-bg-overlay",b.el).aweColorPicker("value",d.imageBgOverlay);a("#slideshow-layout-tab",b.el).initBoxModel(d.boxModelSettings);a("#text-slideshow-custom-id",b.el).val(d.customID);a("#text-slideshow-custom-classes",b.el).val(d.customClass);a("#slideshow-custom-attributes",b.el).initAttributes(d.customEnableAttributes,d.customDataAttributes);a("#slideshow-animations",b.el).aweAnimation("value",{enabled:d.customEnableAnimations,animations:d.customDataAnimations,previewEl:b.editingModel.view.$el})},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Slide Show</h2></div>'},custom_style:{type:"section",select_image:{type:"gallery",title:"Add Images",columns:4},style_image:{type:"image_style_list",title:"Image Style",attributes:{"class":["long-title"]}},effect:{type:"select",title:"Effect",options:{fade:"Fade",backSlide:"Back Slide",goDown:"Go Down",fadeUp:"Fade Up"},default_value:"fade"},navigation:{type:"select",title:"Nav",options:{none:"None",button:"Button",thumbnail:"Thumbnail",number:"Number"},default_value:"none"},style_thumbnail:{type:"image_style_list",title:"Thumbnail Image Style",attributes:{"class":["long-title"]}},position_thumbnail:{type:"select",title:"Position",options:{top:"Top",bottom:"Bottom"},default_value:"bottom"},show_control:{type:"toggle",title:"Show controls",default_value:0}},custom_easing:{type:"section",autoplay:{type:"toggle",title:"AutoPlay",default_value:0},stop_on_hover:{type:"toggle",title:"Stop On Hover",default_value:1},speed:{type:"slider",title:"Speed",min_value:0,max_value:10000,default_value:4000,unit:"ms",allow_type:true},"trans-speed":{type:"slider",title:"Trans Speed",min_value:0,max_value:10000,default_value:500,unit:"ms",allow_type:true}},custom_control:{type:"section",enable_caption:{type:"toggle",title:"Caption",default_value:0},caption_color:{type:"colorpicker",title:"Caption Color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}},position_caption:{type:"select",title:"Position",options:{top:"Top",bottom:"Bottom",over:"Over"},default_value:"top"},on_hover:{type:"toggle",title:"Display on hover",default_value:0},image_bg_overlay:{type:"colorpicker",title:"BgOverlay",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}}},box_settings:{type:"section",layout_tab:{type:"tabs",tabs:[{tab_title:"Border",contents:{header_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{header_boder_radius:{type:"box_model",model_type:"border_radius",min_value:0,max_value:100,allow_type:true}}},{tab_title:"Padding",contents:{header_padding:{type:"box_model",model_type:"padding",allow_type:true,min_value:0,max_value:100}}},{tab_title:"Margin",contents:{header_margin:{type:"box_model",model_type:"margin",allow_type:true,min_value:0,max_value:100}}}]}},definitions:{type:"section",custom_id:{type:"text_field",title:"ID",default_value:""},custom_classes:{type:"text_field",title:"Class",default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}});a(document).ready(function(){AWEContent.Controllers.slideshow=new AWEContent.Views.SlideShowController();AWEContent.Panels.slideshow=new AWEContent.Views.SlideShowPanel()})})(jQuery);