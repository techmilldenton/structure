(function(a){AWEContent.Models.MessageItem=AWEContent.Models.Item.extend({defaults:{machine_name:"message",textMessage:"Type your message here",messageType:"alert-success",fontFamily:"",fontStyle:"",textAlign:"left",fontSize:-1,lineHeight:-1,letterSpacing:-1,color:"",backgroundColor:"",boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type" : "none"}',lgResponsive:true,xsResponsive:true,mediumResponsive:true,smResponsive:true},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.MessageItem({model:this})},clone:function(){var b={};a.each(this.toJSON(),function(c,d){b[c]=d});b.boxModelSettings=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);return new AWEContent.Models.MessageItem(b)}});AWEContent.Views.MessageItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var b=this,e=b.model.toJSON(),c=a('<div class="awe-message awe-item alert"></div>'),d={"font-size":e.fontSize==-1?"":(e.fontSize+"px"),"line-height":e.lineHeight==-1?"":(e.lineHeight+"px"),"letter-spacing":e.letterSpacing==-1?"":(e.letterSpacing+"px"),color:e.color,"background-color":e.backgroundColor,"font-family":e.fontFamily};if(e.fontStyle){d=a.extend({},d,JSON.parse(e.fontStyle))}c.addClass((e.messageType)).css(d).html(e.textMessage).renderItemDefaultBoxModel(e.boxModelSettings);if(e.customClass!=""){c.addClass(e.customClass)}if(e.customID){c.attr("id",e.customID)}c.renderItemDefaultAttributes(e.customEnableAttributes,e.customDataAttributes);if(e.customEnableAnimations){c.processAnimations(e.customDataAnimations)}b.iframeJQuery(this.el).delegate(".awe-message","itemReady",function(){var f,g;b.iframeJQuery(this).hallo({plugins:{halloformat:{formattings:{bold:true,italic:true,underline:true,strikethrough:true}},hallojustify:{},hallolists:{lists:{ordered:true,unordered:true}}},create:function(){this.addEventListener("paste",function(h){h.preventDefault();var i=h.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",false,i)})},editable:true,activate:function(h){f=a(h.target).height()},deactivated:function(h){b.changeContent(h);g=a(h.target).height();if(g!=f){b.resizeItem()}}})});b.$el.defaultResponsive(e);return c},applySettingsChanged:function(d){var b=this,e=b.model.toJSON(),c=a("> .awe-message",b.el),f=b.$el.height();a.each(d.changedAttributes(),function(i,k){b.$el.changeResponsive(i,k);c.renderChangeSettingBoxModel(i,k,d);switch(i){case"messageType":var g=b.model.previousAttributes().messageType;c.removeClass(g).addClass(k);break;case"fontFamily":c.css("font-family",k);break;case"fontStyle":var m=(k)?JSON.parse(k):{"font-weight":"","font-style":""};c.css(m);break;case"textAlign":c.css("text-align",k);break;case"fontSize":k==-1?c.css("font-size",""):c.css("font-size",k+"px");break;case"lineHeight":k==-1?c.css("line-height",""):c.css("line-height",k+"px");break;case"letterSpacing":k==-1?c.css("letter-spacing",""):c.css("letter-spacing",k+"px");break;case"color":c.css("color",k);break;case"backgroundColor":c.css("background-color",k);break;case"customID":c.attr("id",k);break;case"customClass":var l=b.model.previousAttributes().customClass;c.removeClass(l).addClass(k);break;case"customEnableAttributes":c.renderChangeSettingsAttributes(i,k,e.customDataAttributes);break;case"customActionAttributes":c.renderChangeSettingsAttributes(i,k);break;case"customEnableAnimations":var j,h;if(k){j=e.customDataAnimations;h=null;c.processAnimations(j)}else{j=null;h=e.customDataAnimations;c.processAnimations(j,h)}break;case"customDataAnimations":var j,h;j=e.customDataAnimations;h=b.model.previousAttributes().customDataAnimations;c.processAnimations(j,h);break}});setTimeout(function(){b.checkChangeHeight(f)},50)},changeContent:function(c){var b=a(c.currentTarget).html();this.model.set("textMessage",b)}});AWEContent.Views.MessageItemController=AWEContent.Views.ItemController.extend({machineName:"message",controllerHtml:function(){return'<div class="title-icon">Message</div><i class="ic ac-icon-message"></i>'},createItemModel:function(b){var c;if(b!=undefined){c=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);b.boxModelSettings=c;return new AWEContent.Models.MessageItem(b)}return new AWEContent.Models.MessageItem({boxModelSettings:new AWEContent.Models.BoxModelSettings()})}});AWEContent.Views.MessagePanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel panel-message",panelName:"message",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var b=this;a("#message-style",this.$el).change(function(d,c){b.editingModel.set("messageType",c.value)});a("#message-font-name",this.$el).bind("fontFamilyChange",function(d,c){b.editingModel.set("fontFamily",c)}).bind("fontStyleChange",function(c,d){b.editingModel.set("fontStyle",d.value)}).bind("textAlignChange",function(d,c){b.editingModel.set("textAlign",c.value)}).bind("fontSizeChange",function(c,d){b.editingModel.set("fontSize",d.value)}).bind("letterSpacingChange",function(c,d){b.editingModel.set("letterSpacing",d.value)}).bind("lineHeightChange",function(d,c){b.editingModel.set("lineHeight",c.value)});a("#message-color",this.$el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("color",c)});a("#message-background-color",this.$el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("backgroundColor",c)});a("#message-column-box-model",b.el).initBoxModelPanel(b,"boxModelSettings");a("#text-message-custom-id",b.el).change(function(){b.editingModel.set("customID",a(this).val())});a("#text-message-custom-class",b.el).change(function(){b.editingModel.set("customClass",a(this).val())});a("#message-custom-attributes",this.el).initAttributesPanel(b);a("#message-animations",this.el).change(function(c,d){b.editingModel.set("customEnableAnimations",d.enabled);if(d){b.editingModel.set("customDataAnimations",d.animations)}})},setPanelElementsValue:function(){var b=this,c=this.editingModel.toJSON();a("#message-style",this.$el).aweSelect("value",c.messageType);a("#message-font-name",this.$el).aweFont("options",{fontFamily:c.fontFamily,fontStyle:c.fontStyle,textAlign:c.textAlign,fontSize:c.fontSize,lineHeight:c.lineHeight,letterSpacing:c.letterSpacing});a("#message-color",this.$el).aweColorPicker("value",c.color);a("#message-background-color",this.$el).aweColorPicker("value",c.backgroundColor);a("#message-column-box-model",this.$el).initBoxModel(c.boxModelSettings);a("#text-message-custom-id",this.$el).val(c.customID);a("#text-message-custom-class",this.$el).val(c.customClass);a("#message-custom-attributes",this.$el).initAttributes(c.customEnableAttributes,c.customDataAttributes);a("#message-animations",this.$el).aweAnimation("value",{enabled:c.customEnableAnimations,animations:c.customDataAnimations,previewEl:b.editingModel.view.$el})},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Message</h2></div>'},custom_type:{type:"section",style:{type:"select",title:"Type",options:{"alert-success":"Success","alert-info":"Info","alert-warning":"Warning","alert-danger":"Danger"},default_value:"alert-success"}},custom_style:{type:"section",font_name:{type:"font"}},custom_color:{type:"section",color:{type:"colorpicker",title:"Color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}},background_color:{type:"colorpicker",title:"Background color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}}},custom_box_model:{type:"section",column_box_model:{type:"tabs",tabs:[{tab_title:"Border",contents:{custom_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{custom_border_radius:{type:"box_model",model_type:"border_radius",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Padding",contents:{custom_padding:{type:"box_model",model_type:"padding",allow_type:true,min_value:0,max_value:100,default_value:0}}},{tab_title:"Margin",contents:{custom_margin:{type:"box_model",model_type:"margin",allow_type:true,min_value:0,max_value:100,default_value:0}}}]}},custom_definitions:{type:"section",custom_id:{type:"text_field",title:"ID",attributes:{placeholder:"wrapper"},default_value:""},custom_class:{type:"text_field",title:"CSS class",attributes:{placeholder:"wrapper"},default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}});a(document).ready(function(){AWEContent.Controllers.message=new AWEContent.Views.MessageItemController();AWEContent.Panels.message=new AWEContent.Views.MessagePanel()})})(jQuery);