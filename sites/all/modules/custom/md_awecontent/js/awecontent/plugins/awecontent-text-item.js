(function(a){AWEContent.Models.TextItem=AWEContent.Models.Item.extend({defaults:{machine_name:"text",textContent:"This is a custom text. You can use editor to change how it display. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",fontFamily:"",fontStyle:"",textAlign:"left",fontSize:-1,lineHeight:-1,letterSpacing:-1,color:"",backgroundColor:"",boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[]",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type": "none"}',lgResponsive:true,xsResponsive:true,mediumResponsive:true,smResponsive:true},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.TextItem({model:this})},clone:function(){var b={};a.each(this.toJSON(),function(c,d){b[c]=d});b.boxModelSettings=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);return new AWEContent.Models.TextItem(b)}});AWEContent.Views.TextItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var c=this,e=c.model.toJSON(),b=a('<div class="awe-text awe-item"></div>'),d=b,f={"font-family":e.fontFamily,"text-align":e.textAlign,"font-size":e.fontSize==-1?"":(e.fontSize+"px"),"line-height":e.lineHeight==-1?"":(e.lineHeight+"px"),"letter-spacing":e.letterSpacing==-1?"":(e.letterSpacing+"px"),color:e.color,"background-color":e.backgroundColor};if(e.fontStyle){f=a.extend({},f,JSON.parse(e.fontStyle))}d.html(e.textContent);b.css(f).renderItemDefaultBoxModel(e.boxModelSettings);if(e.customID!=""){b.attr("id",e.customID)}if(e.customClass!=""){b.addClass(e.customClass)}if(e.customEnableAnimations){b.processAnimations(e.customDataAnimations)}b.renderItemDefaultAttributes(e.customEnableAttributes,e.customDataAttributes);c.iframeJQuery(this.el).delegate(".awe-text","itemReady",function(){var g,h;c.iframeJQuery(this).hallo({plugins:{halloformat:{formattings:{bold:true,italic:true,underline:true,strikethrough:true}},hallojustify:{},hallolink:{},hallolists:{lists:{ordered:true,unordered:true}}},create:function(){this.addEventListener("paste",function(i){i.preventDefault();var j=i.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",false,j)})},editable:true,activated:function(i){g=a(i.target).height()},deactivated:function(i){c.changeContent(i);h=a(i.target).height();if(h!=h){c.resizeItem()}}})});c.$el.defaultResponsive(e);return b},applySettingsChanged:function(d){var c=this,f=a(".awe-text",c.el),e=d.toJSON(),h,b,g=c.$el.height();a.each(d.changedAttributes(),function(k,m){c.$el.changeResponsive(k,m);f.renderChangeSettingBoxModel(k,m,d);switch(k){case"fontFamily":if(m=="Default"){f.css("font-family","")}else{f.css("font-family",m)}break;case"fontStyle":var n=(m)?JSON.parse(m):{"font-weight":"","font-style":""};f.css(n);break;case"textAlign":f.css("text-align",m);break;case"fontSize":m==-1?f.css("font-size",""):f.css("font-size",m+"px");break;case"lineHeight":m==-1?f.css("line-height",""):f.css("line-height",m+"px");break;case"letterSpacing":m==-1?f.css("letter-spacing",""):f.css("letter-spacing",m+"px");break;case"color":f.css("color",m);break;case"backgroundColor":f.css("background-color",m);break;case"customID":f.attr("id",m);break;case"customClass":var j=c.model.previousAttributes().customClass;f.removeClass(j).addClass(m);break;case"customEnableAttributes":f.renderChangeSettingsAttributes(k,m,e.customDataAttributes);break;case"customActionAttributes":f.renderChangeSettingsAttributes(k,m);break;case"customEnableAnimations":var l,i;if(m){l=e.customDataAnimations;i=null;f.processAnimations(l)}else{l=null;i=e.customDataAnimations;f.processAnimations(l,i)}break;case"customDataAnimations":var l,i;l=e.customDataAnimations;i=c.model.previousAttributes().customDataAnimations;f.processAnimations(l,i);break}});setTimeout(function(){c.checkChangeHeight(g)},50)},changeContent:function(c){var b=a(c.currentTarget).html();this.model.set("textContent",b)}});AWEContent.Views.TextItemController=AWEContent.Views.ItemController.extend({machineName:"text",controllerHtml:function(){return'<div class="title-icon">Text</div><i class="ic ac-icon-text"></i>'},createItemModel:function(b){var c;if(b!=undefined){c=new AWEContent.Models.BoxModelSettings(b.boxModelSettings);b.boxModelSettings=c;return new AWEContent.Models.TextItem(b)}return new AWEContent.Models.TextItem({boxModelSettings:new AWEContent.Models.BoxModelSettings()})}});AWEContent.Views.TextPanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel text-panel",panelName:"text",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var b=this;a("#text-font",this.$el).bind("fontFamilyChange",function(d,c){b.editingModel.set("fontFamily",c)}).bind("fontStyleChange",function(c,d){b.editingModel.set("fontStyle",d.value)}).bind("textAlignChange",function(d,c){b.editingModel.set("textAlign",c.value)}).bind("fontSizeChange",function(c,d){b.editingModel.set("fontSize",d.value)}).bind("letterSpacingChange",function(c,d){b.editingModel.set("letterSpacing",d.value)}).bind("lineHeightChange",function(d,c){b.editingModel.set("lineHeight",c.value)});a("#text-text-color",this.$el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("color",c)});a("#text-background-color",this.$el).change(function(d,c){if(c){c=c.toRgbString()}else{c=""}b.editingModel.set("backgroundColor",c)});a("#text-layout-tab",this.el).initBoxModelPanel(this,"boxModelSettings");a("#text-text-custom-id",this.el).change(function(c,d){b.editingModel.set("customID",a(this).val())});a("#text-text-custom-classes",this.el).change(function(){b.editingModel.set("customClass",a(this).val())});a("#text-custom-attributes",this.el).initAttributesPanel(b);a("#text-animations",this.el).change(function(c,d){b.editingModel.set("customEnableAnimations",d.enabled);if(d){b.editingModel.set("customDataAnimations",d.animations)}});a("#text-layout-tab",b.el).initBoxModelPanel(b,"boxModelSettings")},setPanelElementsValue:function(){var c=this.editingModel.toJSON(),b=this;a("#text-font",this.$el).aweFont("options",{fontFamily:c.fontFamily,fontStyle:c.fontStyle,fontSize:c.fontSize,textAlign:c.textAlign,letterSpacing:c.letterSpacing,lineHeight:c.lineHeight});a("#text-text-color",this.$el).aweColorPicker("value",c.color);a("#text-background-color",this.$el).aweColorPicker("value",c.backgroundColor);a("#text-layout-tab",this.el).initBoxModel(c.boxModelSettings);a("#text-text-custom-id",this.el).val(c.customID);a("#text-text-custom-classes",this.el).val(c.customClass);a("#text-custom-attributes input[name=enabled_custom_attributes]",this.el).val(c.customEnableAttributes).trigger("change");a("#text-custom-attributes input[name=attributes_data]",this.el).val(c.customDataAttributes);a("#text-custom-attributes",this.el).initAttributes(c.customEnableAttributes,c.customDataAttributes);a("#text-animations",this.el).aweAnimation("value",{enabled:c.customEnableAnimations,animations:c.customDataAnimations,previewEl:b.editingModel.view.$el})},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Custom Text</h2></div>'},custom_type:{type:"section",font:{type:"font"}},color:{type:"section",text_color:{type:"colorpicker",title:"Text Color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}},background_color:{type:"colorpicker",title:"Background Color",options:{preferredFormat:"rgb",AlphaVerticle:true,showAlpha:true,allowEmpty:true,showInput:true}}},box_settings:{type:"section",layout_tab:{type:"tabs",tabs:[{tab_title:"Border",contents:{header_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{header_boder_radius:{type:"box_model",model_type:"border_radius",min_value:0,max_value:100,allow_type:true}}},{tab_title:"Padding",contents:{header_padding:{type:"box_model",model_type:"padding",allow_type:true,min_value:0,max_value:100}}},{tab_title:"Margin",contents:{header_margin:{type:"box_model",model_type:"margin",allow_type:true,min_value:0,max_value:100}}}]}},definitions:{type:"section",custom_id:{type:"text_field",title:"ID",default_value:"ID"},custom_classes:{type:"text_field",title:"Classes",default_value:"className"},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}});a(document).ready(function(){AWEContent.Controllers.text=new AWEContent.Views.TextItemController();AWEContent.Panels.text=new AWEContent.Views.TextPanel()})})(jQuery);