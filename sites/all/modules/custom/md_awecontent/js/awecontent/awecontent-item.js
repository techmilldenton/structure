(function(a){AWEContent.Models.Item=Backbone.RelationalModel.extend({hasContentLayout:false,initialize:function(){},getView:function(){return this.view},createView:function(){this.view=new AWEContent.Views.Item({model:this})},removePanelView:function(){var d=this.get("machine_name"),b=AWEContent.Panels[d],c;if(b&&b.isOpenned&&b.$el.data("model.id")==this.cid){b.$el.removeAttr("data-model.id");AWEContent.Panels[d].closePanel()}c=this.collection.remove(this,{silent:true});c.destroy()},getContentColumnModel:function(){}});AWEContent.Views.Item=Backbone.View.extend({iframeJQuery:null,tagName:"div",className:"awe-obj",template:_.template('<div class="awe-custom custom-obj">                <ul>                    <li class="cus-res-mode js-edit-hide"><i class="ic ac-icon-eye"></i></li>                    <li class="js-edit-item"><i class="ic ac-icon-edit"></i></li>                    <li class="js-clone-item"><i class="ic ac-icon-clone"></i></li>                    <li class="js-obj-delete"><i class="ic ac-icon-trash"></i></li>                    <li class="js-obj-move"><i class="ic ac-icon-move"></i></li>                    <li class="js-obj-parent-move" style="display: none"><i class="ic ac-icon-move"></i></li>                    </ul>            </div>'),defaultEvents:{"click > .custom-obj > ul > .js-edit-hide":"showHideElement","click > .custom-obj > ul > .js-obj-delete":"deleteItem","click > .custom-obj > ul > .js-edit-item":"editItem","click > .custom-obj > ul > .js-clone-item":"cloneItem"},additionalEvents:{},events:function(){return _.extend({},this.additionalEvents,this.defaultEvents)},initialize:function(){this.iframeJQuery=AWEContent.jqIframe;this.render();this.listenTo(this.model,"change",this.applySettingsChanged)},render:function(){var d=this,f=this.renderItemContent(),e=(f instanceof jQuery)?f.get(0):a(f).get(0);this.$el.addClass("awe-item-"+this.model.get("machine_name")).addClass("awe-model-"+this.model.cid);this.$el.append(f).append(this.template());if(e){var c=e.tagName.toLowerCase(),b;a.each(e.classList,function(h,g){c+="."+g});c=".awe-model-"+this.model.cid+" > "+c;b=setInterval(function(){if(d.iframeJQuery(c).length){clearInterval(b);d.iframeJQuery(c).trigger("itemReady")}d.$el.parents(".awe-section").trigger("resize")},50)}},showHideElement:function(c){var b=AWEContent.Toolbars.responsive.screen;this.model.set(b,false);AWEContent.Toolbars.responsive.reInitPanel()},renderItemContent:function(){},applySettingsChanged:function(b){},deleteItem:function(){var b=this.$el.parents(".awe-section");this.model.removePanelView();this.remove();b.trigger("resize")},editItem:function(){var b=AWEContent.Panels[this.model.get("machine_name")];b.editModel(this.model)},cloneItem:function(){var b=this.model.clone(),c=this.model.collection.indexOf(this.model);this.model.collection.add(b,{at:c+1})},checkChangeHeight:function(b){if(this.$el.height()!=b){this.resizeItem()}},resizeItem:function(){this.$el.closest(".awe-section").trigger("resize")}});AWEContent.Collections.ListItem=Backbone.Collection.extend({model:AWEContent.Models.Item});AWEContent.Views.ListItem=Backbone.View.extend({tagName:"div",className:"awe-col-wrapper",initialize:function(){this.render();this.initSortable();this.listenTo(this.collection,"add",this.addItem);this.listenTo(this.collection,"relational:remove",this.removeItem);this.listenTo(this.collection,"all",this.actionChangeCollection)},actionChangeCollection:function(c,b,d){this.$el.trigger("actionChangeCollection",{action:c,model:b,collection:d})},initSortable:function(){AWEContent.jqIframe(this.el).sortable({handle:".js-obj-move",connectWith:".awe-col-wrapper",revert:true,tolerance:"pointer",placeholder:"awe-item-placeholder",forceHelperSize:true,forcePlaceholderSize:true,start:function(e,f){f.item.prepend(a('<div class="awe-item-overlay"></div>').css({position:"absolute",width:"100%",height:"100%","z-index":99}));AWEContent.jqIframe(".awe-col-wrapper",AWEContent.documentIframe).sortable("refreshPositions");var c=a("> .awe-obj",f.item.parent()).index(f.item),d=AWEContent.getColumnModelContainItem(f.item);AWEContent.movedItem=null;f.item.data("sorted-model",d.get("items").at(c)).data("prev-col",d);if(a(this).closest(".awe-accordion").length){a.each(f.item.parents(".content-accor"),function(){a(this).css("display","inline")})}AWEContent.iframe.contents().find(".awe-col").addClass("awe-blank");AWEContent.iframe.contents().find(".awe-item-iframe").prepend('<div class="awe-iframe-overlay"></div>');var g,b;a.each(a(".awe-item",f.item),function(){g=a(this).data("animatename");b=a(this).data("animateproperty");a(this).removeClass(g+" "+b)});a.each(a(".awe-item",f.helper),function(){g=a(this).data("animatename");b=a(this).data("animateproperty");a(this).removeClass(g+" "+b)})},stop:function(b,c){if(a(this).closest(".awe-accordion").length){a.each(c.item.parents(".content-accor"),function(){a(this).css("display","block")})}AWEContent.iframe.contents().find(".awe-item-iframe .awe-iframe-overlay").remove();a(".awe-item-overlay",c.item).remove()},update:function(d,e){var c=a("> .awe-obj",e.item.parent()).index(e.item),g=e.item.data("sorted-model"),b=e.item.data("prev-col"),f;if(!e.sender){b.get("items").remove(g,{silent:true});f=AWEContent.getColumnModelContainItem(e.item);f.get("items").add(g,{at:c,silent:true})}}})},render:function(){this.collection.each(function(b){b.createView();this.$el.append(b.getView().$el)},this)},addItem:function(e,f,d){e.createView();var c=e.getView(),b=a("li.item-element",this.$el);if(b.length){c.$el.insertAfter(b);b.remove()}else{c.$el.insertAfter(a("> .awe-obj:eq("+(d.at-1)+")",this.$el))}c.$el.trigger("ready")},removeItem:function(){this.$el.closest(".awe-section").trigger("resize")}});AWEContent.Views.ItemPanel=AWEContent.Views.DefaultPanel.extend({});AWEContent.Views.ItemController=Backbone.View.extend({tagName:"li",className:"item-element",machineName:"",existingElement:false,initialize:function(){this.$el.append(this.controllerHtml()).attr("data-type",this.machineName)},controllerHtml:function(){return""},createItemModel:function(b){return new AWEContent.Models.Item(b)}})})(jQuery);